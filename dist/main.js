(()=>{var vn=Object.create,oe=Object.defineProperty,dn=Object.getPrototypeOf,yn=Object.prototype.hasOwnProperty,gn=Object.getOwnPropertyNames,_n=Object.getOwnPropertyDescriptor;var wn=e=>oe(e,"__esModule",{value:!0});var se=(e,n)=>()=>(n||(n={exports:{}},e(n.exports,n)),n.exports);var mn=(e,n,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of gn(n))!yn.call(e,a)&&a!=="default"&&oe(e,a,{get:()=>n[a],enumerable:!(o=_n(n,a))||o.enumerable});return e},ae=e=>e&&e.__esModule?e:mn(wn(oe(e!=null?vn(dn(e)):{},"default",{value:e,enumerable:!0})),e);var be=se((Ie,Me)=>{(function(e){if(typeof Ie=="object")Me.exports=e();else if(typeof define=="function"&&define.amd)define(e);else{var n;try{n=window}catch(o){n=self}n.SparkMD5=e()}})(function(e){"use strict";var n=function(w,d){return w+d&4294967295},o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(w,d,r,i,c,u){return d=n(n(d,w),n(i,u)),n(d<<c|d>>>32-c,r)}function p(w,d){var r=w[0],i=w[1],c=w[2],u=w[3];r+=(i&c|~i&u)+d[0]-680876936|0,r=(r<<7|r>>>25)+i|0,u+=(r&i|~r&c)+d[1]-389564586|0,u=(u<<12|u>>>20)+r|0,c+=(u&r|~u&i)+d[2]+606105819|0,c=(c<<17|c>>>15)+u|0,i+=(c&u|~c&r)+d[3]-1044525330|0,i=(i<<22|i>>>10)+c|0,r+=(i&c|~i&u)+d[4]-176418897|0,r=(r<<7|r>>>25)+i|0,u+=(r&i|~r&c)+d[5]+1200080426|0,u=(u<<12|u>>>20)+r|0,c+=(u&r|~u&i)+d[6]-1473231341|0,c=(c<<17|c>>>15)+u|0,i+=(c&u|~c&r)+d[7]-45705983|0,i=(i<<22|i>>>10)+c|0,r+=(i&c|~i&u)+d[8]+1770035416|0,r=(r<<7|r>>>25)+i|0,u+=(r&i|~r&c)+d[9]-1958414417|0,u=(u<<12|u>>>20)+r|0,c+=(u&r|~u&i)+d[10]-42063|0,c=(c<<17|c>>>15)+u|0,i+=(c&u|~c&r)+d[11]-1990404162|0,i=(i<<22|i>>>10)+c|0,r+=(i&c|~i&u)+d[12]+1804603682|0,r=(r<<7|r>>>25)+i|0,u+=(r&i|~r&c)+d[13]-40341101|0,u=(u<<12|u>>>20)+r|0,c+=(u&r|~u&i)+d[14]-1502002290|0,c=(c<<17|c>>>15)+u|0,i+=(c&u|~c&r)+d[15]+1236535329|0,i=(i<<22|i>>>10)+c|0,r+=(i&u|c&~u)+d[1]-165796510|0,r=(r<<5|r>>>27)+i|0,u+=(r&c|i&~c)+d[6]-1069501632|0,u=(u<<9|u>>>23)+r|0,c+=(u&i|r&~i)+d[11]+643717713|0,c=(c<<14|c>>>18)+u|0,i+=(c&r|u&~r)+d[0]-373897302|0,i=(i<<20|i>>>12)+c|0,r+=(i&u|c&~u)+d[5]-701558691|0,r=(r<<5|r>>>27)+i|0,u+=(r&c|i&~c)+d[10]+38016083|0,u=(u<<9|u>>>23)+r|0,c+=(u&i|r&~i)+d[15]-660478335|0,c=(c<<14|c>>>18)+u|0,i+=(c&r|u&~r)+d[4]-405537848|0,i=(i<<20|i>>>12)+c|0,r+=(i&u|c&~u)+d[9]+568446438|0,r=(r<<5|r>>>27)+i|0,u+=(r&c|i&~c)+d[14]-1019803690|0,u=(u<<9|u>>>23)+r|0,c+=(u&i|r&~i)+d[3]-187363961|0,c=(c<<14|c>>>18)+u|0,i+=(c&r|u&~r)+d[8]+1163531501|0,i=(i<<20|i>>>12)+c|0,r+=(i&u|c&~u)+d[13]-1444681467|0,r=(r<<5|r>>>27)+i|0,u+=(r&c|i&~c)+d[2]-51403784|0,u=(u<<9|u>>>23)+r|0,c+=(u&i|r&~i)+d[7]+1735328473|0,c=(c<<14|c>>>18)+u|0,i+=(c&r|u&~r)+d[12]-1926607734|0,i=(i<<20|i>>>12)+c|0,r+=(i^c^u)+d[5]-378558|0,r=(r<<4|r>>>28)+i|0,u+=(r^i^c)+d[8]-2022574463|0,u=(u<<11|u>>>21)+r|0,c+=(u^r^i)+d[11]+1839030562|0,c=(c<<16|c>>>16)+u|0,i+=(c^u^r)+d[14]-35309556|0,i=(i<<23|i>>>9)+c|0,r+=(i^c^u)+d[1]-1530992060|0,r=(r<<4|r>>>28)+i|0,u+=(r^i^c)+d[4]+1272893353|0,u=(u<<11|u>>>21)+r|0,c+=(u^r^i)+d[7]-155497632|0,c=(c<<16|c>>>16)+u|0,i+=(c^u^r)+d[10]-1094730640|0,i=(i<<23|i>>>9)+c|0,r+=(i^c^u)+d[13]+681279174|0,r=(r<<4|r>>>28)+i|0,u+=(r^i^c)+d[0]-358537222|0,u=(u<<11|u>>>21)+r|0,c+=(u^r^i)+d[3]-722521979|0,c=(c<<16|c>>>16)+u|0,i+=(c^u^r)+d[6]+76029189|0,i=(i<<23|i>>>9)+c|0,r+=(i^c^u)+d[9]-640364487|0,r=(r<<4|r>>>28)+i|0,u+=(r^i^c)+d[12]-421815835|0,u=(u<<11|u>>>21)+r|0,c+=(u^r^i)+d[15]+530742520|0,c=(c<<16|c>>>16)+u|0,i+=(c^u^r)+d[2]-995338651|0,i=(i<<23|i>>>9)+c|0,r+=(c^(i|~u))+d[0]-198630844|0,r=(r<<6|r>>>26)+i|0,u+=(i^(r|~c))+d[7]+1126891415|0,u=(u<<10|u>>>22)+r|0,c+=(r^(u|~i))+d[14]-1416354905|0,c=(c<<15|c>>>17)+u|0,i+=(u^(c|~r))+d[5]-57434055|0,i=(i<<21|i>>>11)+c|0,r+=(c^(i|~u))+d[12]+1700485571|0,r=(r<<6|r>>>26)+i|0,u+=(i^(r|~c))+d[3]-1894986606|0,u=(u<<10|u>>>22)+r|0,c+=(r^(u|~i))+d[10]-1051523|0,c=(c<<15|c>>>17)+u|0,i+=(u^(c|~r))+d[1]-2054922799|0,i=(i<<21|i>>>11)+c|0,r+=(c^(i|~u))+d[8]+1873313359|0,r=(r<<6|r>>>26)+i|0,u+=(i^(r|~c))+d[15]-30611744|0,u=(u<<10|u>>>22)+r|0,c+=(r^(u|~i))+d[6]-1560198380|0,c=(c<<15|c>>>17)+u|0,i+=(u^(c|~r))+d[13]+1309151649|0,i=(i<<21|i>>>11)+c|0,r+=(c^(i|~u))+d[4]-145523070|0,r=(r<<6|r>>>26)+i|0,u+=(i^(r|~c))+d[11]-1120210379|0,u=(u<<10|u>>>22)+r|0,c+=(r^(u|~i))+d[2]+718787259|0,c=(c<<15|c>>>17)+u|0,i+=(u^(c|~r))+d[9]-343485551|0,i=(i<<21|i>>>11)+c|0,w[0]=r+w[0]|0,w[1]=i+w[1]|0,w[2]=c+w[2]|0,w[3]=u+w[3]|0}function m(w){var d=[],r;for(r=0;r<64;r+=4)d[r>>2]=w.charCodeAt(r)+(w.charCodeAt(r+1)<<8)+(w.charCodeAt(r+2)<<16)+(w.charCodeAt(r+3)<<24);return d}function _(w){var d=[],r;for(r=0;r<64;r+=4)d[r>>2]=w[r]+(w[r+1]<<8)+(w[r+2]<<16)+(w[r+3]<<24);return d}function l(w){var d=w.length,r=[1732584193,-271733879,-1732584194,271733878],i,c,u,M,N,D;for(i=64;i<=d;i+=64)p(r,m(w.substring(i-64,i)));for(w=w.substring(i-64),c=w.length,u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<c;i+=1)u[i>>2]|=w.charCodeAt(i)<<(i%4<<3);if(u[i>>2]|=128<<(i%4<<3),i>55)for(p(r,u),i=0;i<16;i+=1)u[i]=0;return M=d*8,M=M.toString(16).match(/(.*?)(.{0,8})$/),N=parseInt(M[2],16),D=parseInt(M[1],16)||0,u[14]=N,u[15]=D,p(r,u),r}function v(w){var d=w.length,r=[1732584193,-271733879,-1732584194,271733878],i,c,u,M,N,D;for(i=64;i<=d;i+=64)p(r,_(w.subarray(i-64,i)));for(w=i-64<d?w.subarray(i-64):new Uint8Array(0),c=w.length,u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<c;i+=1)u[i>>2]|=w[i]<<(i%4<<3);if(u[i>>2]|=128<<(i%4<<3),i>55)for(p(r,u),i=0;i<16;i+=1)u[i]=0;return M=d*8,M=M.toString(16).match(/(.*?)(.{0,8})$/),N=parseInt(M[2],16),D=parseInt(M[1],16)||0,u[14]=N,u[15]=D,p(r,u),r}function g(w){var d="",r;for(r=0;r<4;r+=1)d+=o[w>>r*8+4&15]+o[w>>r*8&15];return d}function h(w){var d;for(d=0;d<w.length;d+=1)w[d]=g(w[d]);return w.join("")}h(l("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(n=function(w,d){var r=(w&65535)+(d&65535),i=(w>>16)+(d>>16)+(r>>16);return i<<16|r&65535}),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function w(d,r){return d=d|0||0,d<0?Math.max(d+r,0):Math.min(d,r)}ArrayBuffer.prototype.slice=function(d,r){var i=this.byteLength,c=w(d,i),u=i,M,N,D,P;return r!==e&&(u=w(r,i)),c>u?new ArrayBuffer(0):(M=u-c,N=new ArrayBuffer(M),D=new Uint8Array(N),P=new Uint8Array(this,c,M),D.set(P),N)}}();function T(w){return/[\u0080-\uFFFF]/.test(w)&&(w=unescape(encodeURIComponent(w))),w}function S(w,d){var r=w.length,i=new ArrayBuffer(r),c=new Uint8Array(i),u;for(u=0;u<r;u+=1)c[u]=w.charCodeAt(u);return d?c:i}function C(w){return String.fromCharCode.apply(null,new Uint8Array(w))}function $(w,d,r){var i=new Uint8Array(w.byteLength+d.byteLength);return i.set(new Uint8Array(w)),i.set(new Uint8Array(d),w.byteLength),r?i:i.buffer}function b(w){var d=[],r=w.length,i;for(i=0;i<r-1;i+=2)d.push(parseInt(w.substr(i,2),16));return String.fromCharCode.apply(String,d)}function R(){this.reset()}return R.prototype.append=function(w){return this.appendBinary(T(w)),this},R.prototype.appendBinary=function(w){this._buff+=w,this._length+=w.length;var d=this._buff.length,r;for(r=64;r<=d;r+=64)p(this._hash,m(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},R.prototype.end=function(w){var d=this._buff,r=d.length,i,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u;for(i=0;i<r;i+=1)c[i>>2]|=d.charCodeAt(i)<<(i%4<<3);return this._finish(c,r),u=h(this._hash),w&&(u=b(u)),this.reset(),u},R.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},R.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},R.prototype.setState=function(w){return this._buff=w.buff,this._length=w.length,this._hash=w.hash,this},R.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},R.prototype._finish=function(w,d){var r=d,i,c,u;if(w[r>>2]|=128<<(r%4<<3),r>55)for(p(this._hash,w),r=0;r<16;r+=1)w[r]=0;i=this._length*8,i=i.toString(16).match(/(.*?)(.{0,8})$/),c=parseInt(i[2],16),u=parseInt(i[1],16)||0,w[14]=c,w[15]=u,p(this._hash,w)},R.hash=function(w,d){return R.hashBinary(T(w),d)},R.hashBinary=function(w,d){var r=l(w),i=h(r);return d?b(i):i},R.ArrayBuffer=function(){this.reset()},R.ArrayBuffer.prototype.append=function(w){var d=$(this._buff.buffer,w,!0),r=d.length,i;for(this._length+=w.byteLength,i=64;i<=r;i+=64)p(this._hash,_(d.subarray(i-64,i)));return this._buff=i-64<r?new Uint8Array(d.buffer.slice(i-64)):new Uint8Array(0),this},R.ArrayBuffer.prototype.end=function(w){var d=this._buff,r=d.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c,u;for(c=0;c<r;c+=1)i[c>>2]|=d[c]<<(c%4<<3);return this._finish(i,r),u=h(this._hash),w&&(u=b(u)),this.reset(),u},R.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},R.ArrayBuffer.prototype.getState=function(){var w=R.prototype.getState.call(this);return w.buff=C(w.buff),w},R.ArrayBuffer.prototype.setState=function(w){return w.buff=S(w.buff,!0),R.prototype.setState.call(this,w)},R.ArrayBuffer.prototype.destroy=R.prototype.destroy,R.ArrayBuffer.prototype._finish=R.prototype._finish,R.ArrayBuffer.hash=function(w,d){var r=v(new Uint8Array(w)),i=h(r);return d?b(i):i},R})});var Ce=se(Pt=>{(function(e){"use strict";function n(t){return t!==null?Object.prototype.toString.call(t)==="[object Array]":!1}function o(t){return t!==null?Object.prototype.toString.call(t)==="[object Object]":!1}function a(t,s){if(t===s)return!0;var f=Object.prototype.toString.call(t);if(f!==Object.prototype.toString.call(s))return!1;if(n(t)===!0){if(t.length!==s.length)return!1;for(var y=0;y<t.length;y++)if(a(t[y],s[y])===!1)return!1;return!0}if(o(t)===!0){var E={};for(var x in t)if(hasOwnProperty.call(t,x)){if(a(t[x],s[x])===!1)return!1;E[x]=!0}for(var k in s)if(hasOwnProperty.call(s,k)&&E[k]!==!0)return!1;return!0}return!1}function p(t){if(t===""||t===!1||t===null)return!0;if(n(t)&&t.length===0)return!0;if(o(t)){for(var s in t)if(t.hasOwnProperty(s))return!1;return!0}else return!1}function m(t){for(var s=Object.keys(t),f=[],y=0;y<s.length;y++)f.push(t[s[y]]);return f}function _(t,s){var f={};for(var y in t)f[y]=t[y];for(var E in s)f[E]=s[E];return f}var l;typeof String.prototype.trimLeft=="function"?l=function(t){return t.trimLeft()}:l=function(t){return t.match(/^\s*(.*)/)[1]};var v=0,g=1,h=2,T=3,S=4,C=5,$=6,b=7,R=8,w=9,d="EOF",r="UnquotedIdentifier",i="QuotedIdentifier",c="Rbracket",u="Rparen",M="Comma",N="Colon",D="Rbrace",P="Number",W="Current",U="Expref",Z="Pipe",G="Or",Y="And",J="EQ",H="GT",X="LT",et="GTE",pt="LTE",Q="NE",V="Flatten",nt="Star",tt="Filter",q="Dot",Rt="Not",dt="Lbrace",ct="Lbracket",lt="Lparen",Et="Literal",Nt={".":q,"*":nt,",":M,":":N,"{":dt,"}":D,"]":c,"(":lt,")":u,"@":W},Tt={"<":!0,">":!0,"=":!0,"!":!0},O={" ":!0,"	":!0,"\n":!0};function A(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_"}function F(t){return t>="0"&&t<="9"||t==="-"}function j(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t==="_"}function B(){}B.prototype={tokenize:function(t){var s=[];this._current=0;for(var f,y,E;this._current<t.length;)if(A(t[this._current]))f=this._current,y=this._consumeUnquotedIdentifier(t),s.push({type:r,value:y,start:f});else if(Nt[t[this._current]]!==void 0)s.push({type:Nt[t[this._current]],value:t[this._current],start:this._current}),this._current++;else if(F(t[this._current]))E=this._consumeNumber(t),s.push(E);else if(t[this._current]==="[")E=this._consumeLBracket(t),s.push(E);else if(t[this._current]==='"')f=this._current,y=this._consumeQuotedIdentifier(t),s.push({type:i,value:y,start:f});else if(t[this._current]==="'")f=this._current,y=this._consumeRawStringLiteral(t),s.push({type:Et,value:y,start:f});else if(t[this._current]==="`"){f=this._current;var x=this._consumeLiteral(t);s.push({type:Et,value:x,start:f})}else if(Tt[t[this._current]]!==void 0)s.push(this._consumeOperator(t));else if(O[t[this._current]]!==void 0)this._current++;else if(t[this._current]==="&")f=this._current,this._current++,t[this._current]==="&"?(this._current++,s.push({type:Y,value:"&&",start:f})):s.push({type:U,value:"&",start:f});else if(t[this._current]==="|")f=this._current,this._current++,t[this._current]==="|"?(this._current++,s.push({type:G,value:"||",start:f})):s.push({type:Z,value:"|",start:f});else{var k=new Error("Unknown character:"+t[this._current]);throw k.name="LexerError",k}return s},_consumeUnquotedIdentifier:function(t){var s=this._current;for(this._current++;this._current<t.length&&j(t[this._current]);)this._current++;return t.slice(s,this._current)},_consumeQuotedIdentifier:function(t){var s=this._current;this._current++;for(var f=t.length;t[this._current]!=='"'&&this._current<f;){var y=this._current;t[y]==="\\"&&(t[y+1]==="\\"||t[y+1]==='"')?y+=2:y++,this._current=y}return this._current++,JSON.parse(t.slice(s,this._current))},_consumeRawStringLiteral:function(t){var s=this._current;this._current++;for(var f=t.length;t[this._current]!=="'"&&this._current<f;){var y=this._current;t[y]==="\\"&&(t[y+1]==="\\"||t[y+1]==="'")?y+=2:y++,this._current=y}this._current++;var E=t.slice(s+1,this._current-1);return E.replace("\\'","'")},_consumeNumber:function(t){var s=this._current;this._current++;for(var f=t.length;F(t[this._current])&&this._current<f;)this._current++;var y=parseInt(t.slice(s,this._current));return{type:P,value:y,start:s}},_consumeLBracket:function(t){var s=this._current;return this._current++,t[this._current]==="?"?(this._current++,{type:tt,value:"[?",start:s}):t[this._current]==="]"?(this._current++,{type:V,value:"[]",start:s}):{type:ct,value:"[",start:s}},_consumeOperator:function(t){var s=this._current,f=t[s];if(this._current++,f==="!")return t[this._current]==="="?(this._current++,{type:Q,value:"!=",start:s}):{type:Rt,value:"!",start:s};if(f==="<")return t[this._current]==="="?(this._current++,{type:pt,value:"<=",start:s}):{type:X,value:"<",start:s};if(f===">")return t[this._current]==="="?(this._current++,{type:et,value:">=",start:s}):{type:H,value:">",start:s};if(f==="="&&t[this._current]==="=")return this._current++,{type:J,value:"==",start:s}},_consumeLiteral:function(t){this._current++;for(var s=this._current,f=t.length,y;t[this._current]!=="`"&&this._current<f;){var E=this._current;t[E]==="\\"&&(t[E+1]==="\\"||t[E+1]==="`")?E+=2:E++,this._current=E}var x=l(t.slice(s,this._current));return x=x.replace("\\`","`"),this._looksLikeJSON(x)?y=JSON.parse(x):y=JSON.parse('"'+x+'"'),this._current++,y},_looksLikeJSON:function(t){var s='[{"',f=["true","false","null"],y="-0123456789";if(t==="")return!1;if(s.indexOf(t[0])>=0)return!0;if(f.indexOf(t)>=0)return!0;if(y.indexOf(t[0])>=0)try{return JSON.parse(t),!0}catch(E){return!1}else return!1}};var I={};I[d]=0,I[r]=0,I[i]=0,I[c]=0,I[u]=0,I[M]=0,I[D]=0,I[P]=0,I[W]=0,I[U]=0,I[Z]=1,I[G]=2,I[Y]=3,I[J]=5,I[H]=5,I[X]=5,I[et]=5,I[pt]=5,I[Q]=5,I[V]=9,I[nt]=20,I[tt]=21,I[q]=40,I[Rt]=45,I[dt]=50,I[ct]=55,I[lt]=60;function ht(){}ht.prototype={parse:function(t){this._loadTokens(t),this.index=0;var s=this.expression(0);if(this._lookahead(0)!==d){var f=this._lookaheadToken(0),y=new Error("Unexpected token type: "+f.type+", value: "+f.value);throw y.name="ParserError",y}return s},_loadTokens:function(t){var s=new B,f=s.tokenize(t);f.push({type:d,value:"",start:t.length}),this.tokens=f},expression:function(t){var s=this._lookaheadToken(0);this._advance();for(var f=this.nud(s),y=this._lookahead(0);t<I[y];)this._advance(),f=this.led(y,f),y=this._lookahead(0);return f},_lookahead:function(t){return this.tokens[this.index+t].type},_lookaheadToken:function(t){return this.tokens[this.index+t]},_advance:function(){this.index++},nud:function(t){var s,f,y;switch(t.type){case Et:return{type:"Literal",value:t.value};case r:return{type:"Field",name:t.value};case i:var E={type:"Field",name:t.value};if(this._lookahead(0)===lt)throw new Error("Quoted identifier not allowed for function names.");return E;case Rt:return f=this.expression(I.Not),{type:"NotExpression",children:[f]};case nt:return s={type:"Identity"},f=null,this._lookahead(0)===c?f={type:"Identity"}:f=this._parseProjectionRHS(I.Star),{type:"ValueProjection",children:[s,f]};case tt:return this.led(t.type,{type:"Identity"});case dt:return this._parseMultiselectHash();case V:return s={type:V,children:[{type:"Identity"}]},f=this._parseProjectionRHS(I.Flatten),{type:"Projection",children:[s,f]};case ct:return this._lookahead(0)===P||this._lookahead(0)===N?(f=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},f)):this._lookahead(0)===nt&&this._lookahead(1)===c?(this._advance(),this._advance(),f=this._parseProjectionRHS(I.Star),{type:"Projection",children:[{type:"Identity"},f]}):this._parseMultiselectList();case W:return{type:W};case U:return y=this.expression(I.Expref),{type:"ExpressionReference",children:[y]};case lt:for(var x=[];this._lookahead(0)!==u;)this._lookahead(0)===W?(y={type:W},this._advance()):y=this.expression(0),x.push(y);return this._match(u),x[0];default:this._errorToken(t)}},led:function(t,s){var f;switch(t){case q:var y=I.Dot;return this._lookahead(0)!==nt?(f=this._parseDotRHS(y),{type:"Subexpression",children:[s,f]}):(this._advance(),f=this._parseProjectionRHS(y),{type:"ValueProjection",children:[s,f]});case Z:return f=this.expression(I.Pipe),{type:Z,children:[s,f]};case G:return f=this.expression(I.Or),{type:"OrExpression",children:[s,f]};case Y:return f=this.expression(I.And),{type:"AndExpression",children:[s,f]};case lt:for(var E=s.name,x=[],k,z;this._lookahead(0)!==u;)this._lookahead(0)===W?(k={type:W},this._advance()):k=this.expression(0),this._lookahead(0)===M&&this._match(M),x.push(k);return this._match(u),z={type:"Function",name:E,children:x},z;case tt:var ut=this.expression(0);return this._match(c),this._lookahead(0)===V?f={type:"Identity"}:f=this._parseProjectionRHS(I.Filter),{type:"FilterProjection",children:[s,f,ut]};case V:var It={type:V,children:[s]},rt=this._parseProjectionRHS(I.Flatten);return{type:"Projection",children:[It,rt]};case J:case Q:case H:case et:case X:case pt:return this._parseComparator(s,t);case ct:var L=this._lookaheadToken(0);return L.type===P||L.type===N?(f=this._parseIndexExpression(),this._projectIfSlice(s,f)):(this._match(nt),this._match(c),f=this._parseProjectionRHS(I.Star),{type:"Projection",children:[s,f]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(t){if(this._lookahead(0)===t)this._advance();else{var s=this._lookaheadToken(0),f=new Error("Expected "+t+", got: "+s.type);throw f.name="ParserError",f}},_errorToken:function(t){var s=new Error("Invalid token ("+t.type+'): "'+t.value+'"');throw s.name="ParserError",s},_parseIndexExpression:function(){if(this._lookahead(0)===N||this._lookahead(1)===N)return this._parseSliceExpression();var t={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match(c),t},_projectIfSlice:function(t,s){var f={type:"IndexExpression",children:[t,s]};return s.type==="Slice"?{type:"Projection",children:[f,this._parseProjectionRHS(I.Star)]}:f},_parseSliceExpression:function(){for(var t=[null,null,null],s=0,f=this._lookahead(0);f!==c&&s<3;){if(f===N)s++,this._advance();else if(f===P)t[s]=this._lookaheadToken(0).value,this._advance();else{var y=this._lookahead(0),E=new Error("Syntax error, unexpected token: "+y.value+"("+y.type+")");throw E.name="Parsererror",E}f=this._lookahead(0)}return this._match(c),{type:"Slice",children:t}},_parseComparator:function(t,s){var f=this.expression(I[s]);return{type:"Comparator",name:s,children:[t,f]}},_parseDotRHS:function(t){var s=this._lookahead(0),f=[r,i,nt];if(f.indexOf(s)>=0)return this.expression(t);if(s===ct)return this._match(ct),this._parseMultiselectList();if(s===dt)return this._match(dt),this._parseMultiselectHash()},_parseProjectionRHS:function(t){var s;if(I[this._lookahead(0)]<10)s={type:"Identity"};else if(this._lookahead(0)===ct)s=this.expression(t);else if(this._lookahead(0)===tt)s=this.expression(t);else if(this._lookahead(0)===q)this._match(q),s=this._parseDotRHS(t);else{var f=this._lookaheadToken(0),y=new Error("Sytanx error, unexpected token: "+f.value+"("+f.type+")");throw y.name="ParserError",y}return s},_parseMultiselectList:function(){for(var t=[];this._lookahead(0)!==c;){var s=this.expression(0);if(t.push(s),this._lookahead(0)===M&&(this._match(M),this._lookahead(0)===c))throw new Error("Unexpected token Rbracket")}return this._match(c),{type:"MultiSelectList",children:t}},_parseMultiselectHash:function(){for(var t=[],s=[r,i],f,y,E,x;;){if(f=this._lookaheadToken(0),s.indexOf(f.type)<0)throw new Error("Expecting an identifier token, got: "+f.type);if(y=f.value,this._advance(),this._match(N),E=this.expression(0),x={type:"KeyValuePair",name:y,value:E},t.push(x),this._lookahead(0)===M)this._match(M);else if(this._lookahead(0)===D){this._match(D);break}}return{type:"MultiSelectHash",children:t}}};function yt(t){this.runtime=t}yt.prototype={search:function(t,s){return this.visit(t,s)},visit:function(t,s){var f,y,E,x,k,z,ut,It,rt,L;switch(t.type){case"Field":return s===null?null:o(s)?(z=s[t.name],z===void 0?null:z):null;case"Subexpression":for(E=this.visit(t.children[0],s),L=1;L<t.children.length;L++)if(E=this.visit(t.children[1],E),E===null)return null;return E;case"IndexExpression":return ut=this.visit(t.children[0],s),It=this.visit(t.children[1],ut),It;case"Index":if(!n(s))return null;var wt=t.value;return wt<0&&(wt=s.length+wt),E=s[wt],E===void 0&&(E=null),E;case"Slice":if(!n(s))return null;var pn=t.children.slice(0),Vt=this.computeSliceParams(s.length,pn),xe=Vt[0],Se=Vt[1],te=Vt[2];if(E=[],te>0)for(L=xe;L<Se;L+=te)E.push(s[L]);else for(L=xe;L>Se;L+=te)E.push(s[L]);return E;case"Projection":var vt=this.visit(t.children[0],s);if(!n(vt))return null;for(rt=[],L=0;L<vt.length;L++)y=this.visit(t.children[1],vt[L]),y!==null&&rt.push(y);return rt;case"ValueProjection":if(vt=this.visit(t.children[0],s),!o(vt))return null;rt=[];var Ae=m(vt);for(L=0;L<Ae.length;L++)y=this.visit(t.children[1],Ae[L]),y!==null&&rt.push(y);return rt;case"FilterProjection":if(vt=this.visit(t.children[0],s),!n(vt))return null;var ee=[],Oe=[];for(L=0;L<vt.length;L++)f=this.visit(t.children[2],vt[L]),p(f)||ee.push(vt[L]);for(var ne=0;ne<ee.length;ne++)y=this.visit(t.children[1],ee[ne]),y!==null&&Oe.push(y);return Oe;case"Comparator":switch(x=this.visit(t.children[0],s),k=this.visit(t.children[1],s),t.name){case J:E=a(x,k);break;case Q:E=!a(x,k);break;case H:E=x>k;break;case et:E=x>=k;break;case X:E=x<k;break;case pt:E=x<=k;break;default:throw new Error("Unknown comparator: "+t.name)}return E;case V:var re=this.visit(t.children[0],s);if(!n(re))return null;var Bt=[];for(L=0;L<re.length;L++)y=re[L],n(y)?Bt.push.apply(Bt,y):Bt.push(y);return Bt;case"Identity":return s;case"MultiSelectList":if(s===null)return null;for(rt=[],L=0;L<t.children.length;L++)rt.push(this.visit(t.children[L],s));return rt;case"MultiSelectHash":if(s===null)return null;rt={};var ie;for(L=0;L<t.children.length;L++)ie=t.children[L],rt[ie.name]=this.visit(ie.value,s);return rt;case"OrExpression":return f=this.visit(t.children[0],s),p(f)&&(f=this.visit(t.children[1],s)),f;case"AndExpression":return x=this.visit(t.children[0],s),p(x)===!0?x:this.visit(t.children[1],s);case"NotExpression":return x=this.visit(t.children[0],s),p(x);case"Literal":return t.value;case Z:return ut=this.visit(t.children[0],s),this.visit(t.children[1],ut);case W:return s;case"Function":var Re=[];for(L=0;L<t.children.length;L++)Re.push(this.visit(t.children[L],s));return this.runtime.callFunction(t.name,Re);case"ExpressionReference":var Ne=t.children[0];return Ne.jmespathType=U,Ne;default:throw new Error("Unknown node type: "+t.type)}},computeSliceParams:function(t,s){var f=s[0],y=s[1],E=s[2],x=[null,null,null];if(E===null)E=1;else if(E===0){var k=new Error("Invalid slice, step cannot be 0");throw k.name="RuntimeError",k}var z=E<0;return f===null?f=z?t-1:0:f=this.capSliceRange(t,f,E),y===null?y=z?-1:t:y=this.capSliceRange(t,y,E),x[0]=f,x[1]=y,x[2]=E,x},capSliceRange:function(t,s,f){return s<0?(s+=t,s<0&&(s=f<0?-1:0)):s>=t&&(s=f<0?t-1:t),s}};function _t(t){this._interpreter=t,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[v]}]},avg:{_func:this._functionAvg,_signature:[{types:[R]}]},ceil:{_func:this._functionCeil,_signature:[{types:[v]}]},contains:{_func:this._functionContains,_signature:[{types:[h,T]},{types:[g]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[h]},{types:[h]}]},floor:{_func:this._functionFloor,_signature:[{types:[v]}]},length:{_func:this._functionLength,_signature:[{types:[h,T,S]}]},map:{_func:this._functionMap,_signature:[{types:[$]},{types:[T]}]},max:{_func:this._functionMax,_signature:[{types:[R,w]}]},merge:{_func:this._functionMerge,_signature:[{types:[S],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[T]},{types:[$]}]},sum:{_func:this._functionSum,_signature:[{types:[R]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[h]},{types:[h]}]},min:{_func:this._functionMin,_signature:[{types:[R,w]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[T]},{types:[$]}]},type:{_func:this._functionType,_signature:[{types:[g]}]},keys:{_func:this._functionKeys,_signature:[{types:[S]}]},values:{_func:this._functionValues,_signature:[{types:[S]}]},sort:{_func:this._functionSort,_signature:[{types:[w,R]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[T]},{types:[$]}]},join:{_func:this._functionJoin,_signature:[{types:[h]},{types:[w]}]},reverse:{_func:this._functionReverse,_signature:[{types:[h,T]}]},to_array:{_func:this._functionToArray,_signature:[{types:[g]}]},to_string:{_func:this._functionToString,_signature:[{types:[g]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[g]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[g],variadic:!0}]}}}_t.prototype={callFunction:function(t,s){var f=this.functionTable[t];if(f===void 0)throw new Error("Unknown function: "+t+"()");return this._validateArgs(t,s,f._signature),f._func.call(this,s)},_validateArgs:function(t,s,f){var y;if(f[f.length-1].variadic){if(s.length<f.length)throw y=f.length===1?" argument":" arguments",new Error("ArgumentError: "+t+"() takes at least"+f.length+y+" but received "+s.length)}else if(s.length!==f.length)throw y=f.length===1?" argument":" arguments",new Error("ArgumentError: "+t+"() takes "+f.length+y+" but received "+s.length);for(var E,x,k,z=0;z<f.length;z++){k=!1,E=f[z].types,x=this._getTypeName(s[z]);for(var ut=0;ut<E.length;ut++)if(this._typeMatches(x,E[ut],s[z])){k=!0;break}if(!k)throw new Error("TypeError: "+t+"() expected argument "+(z+1)+" to be type "+E+" but received type "+x+" instead.")}},_typeMatches:function(t,s,f){if(s===g)return!0;if(s===w||s===R||s===T){if(s===T)return t===T;if(t===T){var y;s===R?y=v:s===w&&(y=h);for(var E=0;E<f.length;E++)if(!this._typeMatches(this._getTypeName(f[E]),y,f[E]))return!1;return!0}}else return t===s},_getTypeName:function(t){switch(Object.prototype.toString.call(t)){case"[object String]":return h;case"[object Number]":return v;case"[object Array]":return T;case"[object Boolean]":return C;case"[object Null]":return b;case"[object Object]":return t.jmespathType===U?$:S}},_functionStartsWith:function(t){return t[0].lastIndexOf(t[1])===0},_functionEndsWith:function(t){var s=t[0],f=t[1];return s.indexOf(f,s.length-f.length)!==-1},_functionReverse:function(t){var s=this._getTypeName(t[0]);if(s===h){for(var f=t[0],y="",E=f.length-1;E>=0;E--)y+=f[E];return y}else{var x=t[0].slice(0);return x.reverse(),x}},_functionAbs:function(t){return Math.abs(t[0])},_functionCeil:function(t){return Math.ceil(t[0])},_functionAvg:function(t){for(var s=0,f=t[0],y=0;y<f.length;y++)s+=f[y];return s/f.length},_functionContains:function(t){return t[0].indexOf(t[1])>=0},_functionFloor:function(t){return Math.floor(t[0])},_functionLength:function(t){return o(t[0])?Object.keys(t[0]).length:t[0].length},_functionMap:function(t){for(var s=[],f=this._interpreter,y=t[0],E=t[1],x=0;x<E.length;x++)s.push(f.visit(y,E[x]));return s},_functionMerge:function(t){for(var s={},f=0;f<t.length;f++){var y=t[f];for(var E in y)s[E]=y[E]}return s},_functionMax:function(t){if(t[0].length>0){var s=this._getTypeName(t[0][0]);if(s===v)return Math.max.apply(Math,t[0]);for(var f=t[0],y=f[0],E=1;E<f.length;E++)y.localeCompare(f[E])<0&&(y=f[E]);return y}else return null},_functionMin:function(t){if(t[0].length>0){var s=this._getTypeName(t[0][0]);if(s===v)return Math.min.apply(Math,t[0]);for(var f=t[0],y=f[0],E=1;E<f.length;E++)f[E].localeCompare(y)<0&&(y=f[E]);return y}else return null},_functionSum:function(t){for(var s=0,f=t[0],y=0;y<f.length;y++)s+=f[y];return s},_functionType:function(t){switch(this._getTypeName(t[0])){case v:return"number";case h:return"string";case T:return"array";case S:return"object";case C:return"boolean";case $:return"expref";case b:return"null"}},_functionKeys:function(t){return Object.keys(t[0])},_functionValues:function(t){for(var s=t[0],f=Object.keys(s),y=[],E=0;E<f.length;E++)y.push(s[f[E]]);return y},_functionJoin:function(t){var s=t[0],f=t[1];return f.join(s)},_functionToArray:function(t){return this._getTypeName(t[0])===T?t[0]:[t[0]]},_functionToString:function(t){return this._getTypeName(t[0])===h?t[0]:JSON.stringify(t[0])},_functionToNumber:function(t){var s=this._getTypeName(t[0]),f;return s===v?t[0]:s===h&&(f=+t[0],!isNaN(f))?f:null},_functionNotNull:function(t){for(var s=0;s<t.length;s++)if(this._getTypeName(t[s])!==b)return t[s];return null},_functionSort:function(t){var s=t[0].slice(0);return s.sort(),s},_functionSortBy:function(t){var s=t[0].slice(0);if(s.length===0)return s;var f=this._interpreter,y=t[1],E=this._getTypeName(f.visit(y,s[0]));if([v,h].indexOf(E)<0)throw new Error("TypeError");for(var x=this,k=[],z=0;z<s.length;z++)k.push([z,s[z]]);k.sort(function(It,rt){var L=f.visit(y,It[1]),wt=f.visit(y,rt[1]);if(x._getTypeName(L)!==E)throw new Error("TypeError: expected "+E+", received "+x._getTypeName(L));if(x._getTypeName(wt)!==E)throw new Error("TypeError: expected "+E+", received "+x._getTypeName(wt));return L>wt?1:L<wt?-1:It[0]-rt[0]});for(var ut=0;ut<k.length;ut++)s[ut]=k[ut][1];return s},_functionMaxBy:function(t){for(var s=t[1],f=t[0],y=this.createKeyFunction(s,[v,h]),E=-Infinity,x,k,z=0;z<f.length;z++)k=y(f[z]),k>E&&(E=k,x=f[z]);return x},_functionMinBy:function(t){for(var s=t[1],f=t[0],y=this.createKeyFunction(s,[v,h]),E=Infinity,x,k,z=0;z<f.length;z++)k=y(f[z]),k<E&&(E=k,x=f[z]);return x},createKeyFunction:function(t,s){var f=this,y=this._interpreter,E=function(x){var k=y.visit(t,x);if(s.indexOf(f._getTypeName(k))<0){var z="TypeError: expected one of "+s+", received "+f._getTypeName(k);throw new Error(z)}return k};return E}};function Ft(t){var s=new ht,f=s.parse(t);return f}function kt(t){var s=new B;return s.tokenize(t)}function xt(t,s){var f=new ht,y=new _t,E=new yt(y);y._interpreter=E;var x=f.parse(s);return E.search(x,t)}e.tokenize=kt,e.compile=Ft,e.search=xt,e.strictDeepEqual=a})(typeof Pt=="undefined"?Pt.jmespath={}:Pt)});var We=se((ge,_e)=>{(function(e,n){typeof define=="function"&&define.amd?define([],n):typeof ge!="undefined"?n():(n(),e.FileSaver={exports:{}}.exports)})(ge,function(){"use strict";function e(l,v){return typeof v=="undefined"?v={autoBom:!1}:typeof v!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),v={autoBom:!v}),v.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function n(l,v,g){var h=new XMLHttpRequest;h.open("GET",l),h.responseType="blob",h.onload=function(){_(h.response,v,g)},h.onerror=function(){console.error("could not download file")},h.send()}function o(l){var v=new XMLHttpRequest;v.open("HEAD",l,!1);try{v.send()}catch(g){}return 200<=v.status&&299>=v.status}function a(l){try{l.dispatchEvent(new MouseEvent("click"))}catch(g){var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(v)}}var p=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,m=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=p.saveAs||(typeof window!="object"||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(l,v,g){var h=p.URL||p.webkitURL,T=document.createElement("a");v=v||l.name||"download",T.download=v,T.rel="noopener",typeof l=="string"?(T.href=l,T.origin===location.origin?a(T):o(T.href)?n(l,v,g):a(T,T.target="_blank")):(T.href=h.createObjectURL(l),setTimeout(function(){h.revokeObjectURL(T.href)},4e4),setTimeout(function(){a(T)},0))}:"msSaveOrOpenBlob"in navigator?function(l,v,g){if(v=v||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(e(l,g),v);else if(o(l))n(l,v,g);else{var h=document.createElement("a");h.href=l,h.target="_blank",setTimeout(function(){a(h)})}}:function(l,v,g,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof l=="string")return n(l,v,g);var T=l.type==="application/octet-stream",S=/constructor/i.test(p.HTMLElement)||p.safari,C=/CriOS\/[\d]+/.test(navigator.userAgent);if((C||T&&S||m)&&typeof FileReader!="undefined"){var $=new FileReader;$.onloadend=function(){var w=$.result;w=C?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=w:location=w,h=null},$.readAsDataURL(l)}else{var b=p.URL||p.webkitURL,R=b.createObjectURL(l);h?h.location=R:location.href=R,h=null,setTimeout(function(){b.revokeObjectURL(R)},4e4)}});p.saveAs=_.saveAs=_,typeof _e!="undefined"&&(_e.exports=_)})});var cn=ae(be()),hn=ae(Ce());var Fe={},En=function(e,n,o,a,p){var m=Fe[n]||(Fe[n]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))),_=new Worker(m);return _.onerror=function(l){return p(l.error,null)},_.onmessage=function(l){return p(null,l.data)},_.postMessage(o,a),_},it=Uint8Array,ot=Uint16Array,St=Uint32Array,Ht=new it([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Kt=new it([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ue=new it([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ke=function(e,n){for(var o=new ot(31),a=0;a<31;++a)o[a]=n+=1<<e[a-1];for(var p=new St(o[30]),a=1;a<30;++a)for(var m=o[a];m<o[a+1];++m)p[m]=m-o[a]<<5|a;return[o,p]},Le=ke(Ht,2),Tn=Le[0],Gt=Le[1];Tn[28]=258,Gt[258]=28;var $e=ke(Kt,0),ir=$e[0],fe=$e[1],Yt=new ot(32768);for(var K=0;K<32768;++K)mt=(K&43690)>>>1|(K&21845)<<1,mt=(mt&52428)>>>2|(mt&13107)<<2,mt=(mt&61680)>>>4|(mt&3855)<<4,Yt[K]=((mt&65280)>>>8|(mt&255)<<8)>>>1;var mt,Mt=function(e,n,o){for(var a=e.length,p=0,m=new ot(n);p<a;++p)++m[e[p]-1];var _=new ot(n);for(p=0;p<n;++p)_[p]=_[p-1]+m[p-1]<<1;var l;if(o){l=new ot(1<<n);var v=15-n;for(p=0;p<a;++p)if(e[p])for(var g=p<<4|e[p],h=n-e[p],T=_[e[p]-1]++<<h,S=T|(1<<h)-1;T<=S;++T)l[Yt[T]>>>v]=g}else for(l=new ot(a),p=0;p<a;++p)e[p]&&(l[p]=Yt[_[e[p]-1]++]>>>15-e[p]);return l},At=new it(288);for(var K=0;K<144;++K)At[K]=8;for(var K=144;K<256;++K)At[K]=9;for(var K=256;K<280;++K)At[K]=7;for(var K=280;K<288;++K)At[K]=8;var Lt=new it(32);for(var K=0;K<32;++K)Lt[K]=5;var ze=Mt(At,9,0);var je=Mt(Lt,5,0);var ce=function(e){return(e/8|0)+(e&7&&1)},he=function(e,n,o){(n==null||n<0)&&(n=0),(o==null||o>e.length)&&(o=e.length);var a=new(e instanceof ot?ot:e instanceof St?St:it)(o-n);return a.set(e.subarray(n,o)),a};var gt=function(e,n,o){o<<=n&7;var a=n/8|0;e[a]|=o,e[a+1]|=o>>>8},bt=function(e,n,o){o<<=n&7;var a=n/8|0;e[a]|=o,e[a+1]|=o>>>8,e[a+2]|=o>>>16},Zt=function(e,n){for(var o=[],a=0;a<e.length;++a)e[a]&&o.push({s:a,f:e[a]});var p=o.length,m=o.slice();if(!p)return[Wt,0];if(p==1){var _=new it(o[0].s+1);return _[o[0].s]=1,[_,1]}o.sort(function(c,u){return c.f-u.f}),o.push({s:-1,f:25001});var l=o[0],v=o[1],g=0,h=1,T=2;for(o[0]={s:-1,f:l.f+v.f,l,r:v};h!=p-1;)l=o[o[g].f<o[T].f?g++:T++],v=o[g!=h&&o[g].f<o[T].f?g++:T++],o[h++]={s:-1,f:l.f+v.f,l,r:v};for(var S=m[0].s,a=1;a<p;++a)m[a].s>S&&(S=m[a].s);var C=new ot(S+1),$=qt(o[h-1],C,0);if($>n){var a=0,b=0,R=$-n,w=1<<R;for(m.sort(function(u,M){return C[M.s]-C[u.s]||u.f-M.f});a<p;++a){var d=m[a].s;if(C[d]>n)b+=w-(1<<$-C[d]),C[d]=n;else break}for(b>>>=R;b>0;){var r=m[a].s;C[r]<n?b-=1<<n-C[r]++-1:++a}for(;a>=0&&b;--a){var i=m[a].s;C[i]==n&&(--C[i],++b)}$=n}return[new it(C),$]},qt=function(e,n,o){return e.s==-1?Math.max(qt(e.l,n,o+1),qt(e.r,n,o+1)):n[e.s]=o},le=function(e){for(var n=e.length;n&&!e[--n];);for(var o=new ot(++n),a=0,p=e[0],m=1,_=function(v){o[a++]=v},l=1;l<=n;++l)if(e[l]==p&&l!=n)++m;else{if(!p&&m>2){for(;m>138;m-=138)_(32754);m>2&&(_(m>10?m-11<<5|28690:m-3<<5|12305),m=0)}else if(m>3){for(_(p),--m;m>6;m-=6)_(8304);m>2&&(_(m-3<<5|8208),m=0)}for(;m--;)_(p);m=1,p=e[l]}return[o.subarray(0,a),n]},Ct=function(e,n){for(var o=0,a=0;a<n.length;++a)o+=e[a]*n[a];return o},$t=function(e,n,o){var a=o.length,p=ce(n+2);e[p]=a&255,e[p+1]=a>>>8,e[p+2]=e[p]^255,e[p+3]=e[p+1]^255;for(var m=0;m<a;++m)e[p+m+4]=o[m];return(p+4+a)*8},pe=function(e,n,o,a,p,m,_,l,v,g,h){gt(n,h++,o),++p[256];for(var T=Zt(p,15),S=T[0],C=T[1],$=Zt(m,15),b=$[0],R=$[1],w=le(S),d=w[0],r=w[1],i=le(b),c=i[0],u=i[1],M=new ot(19),N=0;N<d.length;++N)M[d[N]&31]++;for(var N=0;N<c.length;++N)M[c[N]&31]++;for(var D=Zt(M,7),P=D[0],W=D[1],U=19;U>4&&!P[ue[U-1]];--U);var Z=g+5<<3,G=Ct(p,At)+Ct(m,Lt)+_,Y=Ct(p,S)+Ct(m,b)+_+14+3*U+Ct(M,P)+(2*M[16]+3*M[17]+7*M[18]);if(Z<=G&&Z<=Y)return $t(n,h,e.subarray(v,v+g));var J,H,X,et;if(gt(n,h,1+(Y<G)),h+=2,Y<G){J=Mt(S,C,0),H=S,X=Mt(b,R,0),et=b;var pt=Mt(P,W,0);gt(n,h,r-257),gt(n,h+5,u-1),gt(n,h+10,U-4),h+=14;for(var N=0;N<U;++N)gt(n,h+3*N,P[ue[N]]);h+=3*U;for(var Q=[d,c],V=0;V<2;++V)for(var nt=Q[V],N=0;N<nt.length;++N){var tt=nt[N]&31;gt(n,h,pt[tt]),h+=P[tt],tt>15&&(gt(n,h,nt[N]>>>5&127),h+=nt[N]>>>12)}}else J=ze,H=At,X=je,et=Lt;for(var N=0;N<l;++N)if(a[N]>255){var tt=a[N]>>>18&31;bt(n,h,J[tt+257]),h+=H[tt+257],tt>7&&(gt(n,h,a[N]>>>23&31),h+=Ht[tt]);var q=a[N]&31;bt(n,h,X[q]),h+=et[q],q>3&&(bt(n,h,a[N]>>>5&8191),h+=Kt[q])}else bt(n,h,J[a[N]]),h+=H[a[N]];return bt(n,h,J[256]),h+H[256]},De=new St([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Wt=new it(0),Ue=function(e,n,o,a,p,m){var _=e.length,l=new it(a+_+5*(1+Math.ceil(_/7e3))+p),v=l.subarray(a,l.length-p),g=0;if(!n||_<8)for(var h=0;h<=_;h+=65535){var T=h+65535;T<_?g=$t(v,g,e.subarray(h,T)):(v[h]=m,g=$t(v,g,e.subarray(h,_)))}else{for(var S=De[n-1],C=S>>>13,$=S&8191,b=(1<<o)-1,R=new ot(32768),w=new ot(b+1),d=Math.ceil(o/3),r=2*d,i=function(A){return(e[A]^e[A+1]<<d^e[A+2]<<r)&b},c=new St(25e3),u=new ot(288),M=new ot(32),N=0,D=0,h=0,P=0,W=0,U=0;h<_;++h){var Z=i(h),G=h&32767,Y=w[Z];if(R[G]=Y,w[Z]=G,W<=h){var J=_-h;if((N>7e3||P>24576)&&J>423){g=pe(e,v,0,c,u,M,D,P,U,h-U,g),P=N=D=0,U=h;for(var H=0;H<286;++H)u[H]=0;for(var H=0;H<30;++H)M[H]=0}var X=2,et=0,pt=$,Q=G-Y&32767;if(J>2&&Z==i(h-Q))for(var V=Math.min(C,J)-1,nt=Math.min(32767,h),tt=Math.min(258,J);Q<=nt&&--pt&&G!=Y;){if(e[h+X]==e[h+X-Q]){for(var q=0;q<tt&&e[h+q]==e[h+q-Q];++q);if(q>X){if(X=q,et=Q,q>V)break;for(var Rt=Math.min(Q,q-2),dt=0,H=0;H<Rt;++H){var ct=h-Q+H+32768&32767,lt=R[ct],Et=ct-lt+32768&32767;Et>dt&&(dt=Et,Y=ct)}}}G=Y,Y=R[G],Q+=G-Y+32768&32767}if(et){c[P++]=268435456|Gt[X]<<18|fe[et];var Nt=Gt[X]&31,Tt=fe[et]&31;D+=Ht[Nt]+Kt[Tt],++u[257+Nt],++M[Tt],W=h+X,++N}else c[P++]=e[h],++u[e[h]]}}g=pe(e,v,m,c,u,M,D,P,U,h-U,g),!m&&g&7&&(g=$t(v,g+1,Wt))}return he(l,0,a+ce(g)+p)},xn=function(){for(var e=new St(256),n=0;n<256;++n){for(var o=n,a=9;--a;)o=(o&1&&3988292384)^o>>>1;e[n]=o}return e}(),Sn=function(){var e=-1;return{p:function(n){for(var o=e,a=0;a<n.length;++a)o=xn[o&255^n[a]]^o>>>8;e=o},d:function(){return~e}}};var Be=function(e,n,o,a,p){return Ue(e,n.level==null?6:n.level,n.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):12+n.mem,o,a,!p)},ve=function(e,n){var o={};for(var a in e)o[a]=e[a];for(var a in n)o[a]=n[a];return o},Pe=function(e,n,o){for(var a=e(),p=e.toString(),m=p.slice(p.indexOf("[")+1,p.lastIndexOf("]")).replace(/ /g,"").split(","),_=0;_<a.length;++_){var l=a[_],v=m[_];if(typeof l=="function"){n+=";"+v+"=";var g=l.toString();if(l.prototype)if(g.indexOf("[native code]")!=-1){var h=g.indexOf(" ",8)+1;n+=g.slice(h,g.indexOf("(",h))}else{n+=g;for(var T in l.prototype)n+=";"+v+".prototype."+T+"="+l.prototype[T].toString()}else n+=g}else o[v]=l}return[n,o]},Jt=[],An=function(e){var n=[];for(var o in e)(e[o]instanceof it||e[o]instanceof ot||e[o]instanceof St)&&n.push((e[o]=new e[o].constructor(e[o])).buffer);return n},On=function(e,n,o,a){var p;if(!Jt[o]){for(var m="",_={},l=e.length-1,v=0;v<l;++v)p=Pe(e[v],m,_),m=p[0],_=p[1];Jt[o]=Pe(e[l],m,_)}var g=ve({},Jt[o][1]);return En(Jt[o][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+n.toString()+"}",o,g,An(g),a)};var Rn=function(){return[it,ot,St,Ht,Kt,ue,Gt,fe,ze,At,je,Lt,Yt,De,Wt,Mt,gt,bt,Zt,qt,le,Ct,$t,pe,ce,he,Ue,Be,de,He]};var He=function(e){return postMessage(e,[e.buffer])};var Nn=function(e,n,o,a,p,m){var _=On(o,a,p,function(l,v){_.terminate(),m(l,v)});return _.postMessage([e,n],n.consume?[e.buffer]:[]),function(){_.terminate()}};var st=function(e,n,o){for(;o;++n)e[n]=o,o>>>=8};function In(e,n,o){if(o||(o=n,n={}),typeof o!="function")throw"no callback";return Nn(e,n,[Rn],function(a){return He(de(a.data[0],a.data[1]))},0,o)}function de(e,n){return Be(e,n||{},0,0)}var Ke=function(e,n,o,a){for(var p in e){var m=e[p],_=n+p;m instanceof it?o[_]=[m,a]:Array.isArray(m)?o[_]=[m[0],ve(a,m[1])]:Ke(m,_+"/",o,a)}},Ge=typeof TextEncoder!="undefined"&&new TextEncoder,Mn=typeof TextDecoder!="undefined"&&new TextDecoder,bn=0;try{Mn.decode(Wt,{stream:!0}),bn=1}catch(e){}function Xt(e,n){if(n){for(var o=new it(e.length),a=0;a<e.length;++a)o[a]=e.charCodeAt(a);return o}if(Ge)return Ge.encode(e);for(var p=e.length,m=new it(e.length+(e.length>>1)),_=0,l=function(h){m[_++]=h},a=0;a<p;++a){if(_+5>m.length){var v=new it(_+8+(p-a<<1));v.set(m),m=v}var g=e.charCodeAt(a);g<128||n?l(g):g<2048?(l(192|g>>6),l(128|g&63)):g>55295&&g<57344?(g=65536+(g&1023<<10)|e.charCodeAt(++a)&1023,l(240|g>>18),l(128|g>>12&63),l(128|g>>6&63),l(128|g&63)):(l(224|g>>12),l(128|g>>6&63),l(128|g&63))}return he(m,0,_)}var ye=function(e){var n=0;if(e)for(var o in e){var a=e[o].length;if(a>65535)throw"extra field too long";n+=a+4}return n},Ye=function(e,n,o,a,p,m,_,l){var v=a.length,g=o.extra,h=l&&l.length,T=ye(g);st(e,n,_!=null?33639248:67324752),n+=4,_!=null&&(e[n++]=20,e[n++]=o.os),e[n]=20,n+=2,e[n++]=o.flag<<1|(m==null&&8),e[n++]=p&&8,e[n++]=o.compression&255,e[n++]=o.compression>>8;var S=new Date(o.mtime==null?Date.now():o.mtime),C=S.getFullYear()-1980;if(C<0||C>119)throw"date not in range 1980-2099";if(st(e,n,C<<25|S.getMonth()+1<<21|S.getDate()<<16|S.getHours()<<11|S.getMinutes()<<5|S.getSeconds()>>>1),n+=4,m!=null&&(st(e,n,o.crc),st(e,n+4,m),st(e,n+8,o.size)),st(e,n+12,v),st(e,n+14,T),n+=16,_!=null&&(st(e,n,h),st(e,n+6,o.attrs),st(e,n+10,_),n+=14),e.set(a,n),n+=v,T)for(var $ in g){var b=g[$],R=b.length;st(e,n,+$),st(e,n+2,R),e.set(b,n+4),n+=4+R}return h&&(e.set(l,n),n+=h),n},Cn=function(e,n,o,a,p){st(e,n,101010256),st(e,n+8,o),st(e,n+10,o),st(e,n+12,a),st(e,n+16,p)};function qe(e,n,o){if(o||(o=n,n={}),typeof o!="function")throw"no callback";var a={};Ke(e,"",a,n);var p=Object.keys(a),m=p.length,_=0,l=0,v=m,g=new Array(m),h=[],T=function(){for(var b=0;b<h.length;++b)h[b]()},S=function(){var b=new it(l+22),R=_,w=l-_;l=0;for(var d=0;d<v;++d){var r=g[d];try{var i=r.c.length;Ye(b,l,r,r.f,r.u,i);var c=30+r.f.length+ye(r.extra),u=l+c;b.set(r.c,u),Ye(b,_,r,r.f,r.u,i,l,r.m),_+=16+c+(r.m?r.m.length:0),l=u+i}catch(M){return o(M,null)}}Cn(b,_,g.length,w,R),o(null,b)};m||S();for(var C=function(b){var R=p[b],w=a[R],d=w[0],r=w[1],i=Sn(),c=d.length;i.p(d);var u=Xt(R),M=u.length,N=r.comment,D=N&&Xt(N),P=D&&D.length,W=ye(r.extra),U=r.level==0?0:8,Z=function(G,Y){if(G)T(),o(G,null);else{var J=Y.length;g[b]=ve(r,{size:c,crc:i.d(),c:Y,f:u,m:D,u:M!=R.length||D&&N.length!=P,compression:U}),_+=30+M+W+J,l+=76+2*(M+W)+(P||0)+J,--m||S()}};if(M>65535&&Z("filename too long",null),!U)Z(null,d);else if(c<16e4)try{Z(null,de(d,r))}catch(G){Z(G,null)}else h.push(In(d,r,Z))},$=0;$<v;++$)C($);return T}var ln=ae(We());function Ze(e){return{all:e=e||new Map,on:function(n,o){var a=e.get(n);a&&a.push(o)||e.set(n,[o])},off:function(n,o){var a=e.get(n);a&&a.splice(a.indexOf(o)>>>0,1)},emit:function(n,o){(e.get(n)||[]).slice().map(function(a){a(o)}),(e.get("*")||[]).slice().map(function(a){a(n,o)})}}}function Fn(e){return Je(e)&&ft(e.emit)&&(ft(e.addListener)||ft(e.on))&&(ft(e.removeListener)||ft(e.off))}function Xe(e){return Array.isArray(e)}function ft(e){return typeof e=="function"}function at(e){return typeof e=="string"}function Je(e){return typeof e=="object"}function Ot(e){return e===null||!Je(e)?!1:Object.getPrototypeOf(e)===Object.prototype}function kn(e){return at(e)?!0:Xe(e)?e.every(at):!1}var Ln=(e,n,o)=>n(o)?void 0:`${n.name}(${e}) did not return true`,$n=(e,n,o)=>typeof o===n?void 0:`Argument "${e}" should be a ${n}`,zn=(e,n,o)=>{let{argName:a,argType:p}=e[o];if(n===void 0)return`Argument undefined: "${a}"`;let m=Array.isArray(p)?p:[p],_=m.map(g=>ft(g)?Ln(a,g,n):$n(a,g,n)).filter(at);if(m.length>1?_.length>1:_.length)return`${_.join(`
| `)}
> typeof ${a} === ${typeof n}(${JSON.stringify(n)})`};function we(e){return function(n,o,...a){let p=Object.entries(o).map(([l,v])=>({argName:l,argType:v})),m=a.map((...l)=>zn(p,...l)).filter(at);if(!m.length)return;let _=Object.keys(o).join(", ");return`
${e||""}${n}(${_}):
${m.map(l=>`| ${l}`).join(`
`)}`}}function me(e){let n=(l,...v)=>e.emit(l,v),o=e.addListener?(...l)=>e.addListener(...l):(...l)=>e.on(...l),a=e.removeListener?(...l)=>e.removeListener(...l):(...l)=>e.off(...l),p=new Map;function m(l,v){let g=p.get(v);g||(g={handleEvent:h=>v(...h||[]),refCount:0},p.set(v,g)),g.refCount+=1,o(l,g.handleEvent)}function _(l,v){let g=p.get(v);!g||(a(l,g.handleEvent),g.refCount-=1,g.refCount===0&&p.delete(v))}return{emit:n,on:m,off:_}}function Qe(e){return e.reduce((n,o)=>n.indexOf(o)===-1?[...n,o]:n,[])}function jn(e,n){n=n||function(){};let o=!!e;function a(p){return(...m)=>o?(n(),!1):p(...m)}return{Pausable:a,paused:()=>o,pause:()=>{o=!0},resume:()=>{o=!1}}}function Ee(e,n,o,...a){let p=[...a].flat().reduce((T,S)=>({...T,[S]:0}),{});function m(T){return p[T]=l(T)+1,()=>{_(T)}}function _(T){let S=l(T)-1;p[T]=Math.max(S,0)}function l(T){return p[T]||0}function v(){return{...p}}function g(){return Object.keys(p).sort().map(T=>[T,p[T]]).map(([T,S])=>({[n]:T,refs:S||"None"}))}function h(){return{description:`Statebot[${e}]: ${o}:`,table:g()}}return{increase:m,decrease:_,countOf:l,toValue:h,refs:v}}function Dn(e,n){at(e)&&(e={info:3,log:2,warn:1,none:0}[e]||3);function o(){return e>=1}function a(){return e>=2}function p(){return e>=3}let{info:m,table:_,log:l,warn:v,error:g}=n||console;return{canWarn:o,canLog:a,canInfo:p,info:(...h)=>{p()&&m(...h)},table:(...h)=>{a()&&_(...h)},log:(...h)=>{a()&&l(...h)},warn:(...h)=>{o()&&v(...h)},error:(...h)=>{g(...h)}}}var Un=/[\r\n]/,Ve="|",zt="->",Bn=[Ve,zt].map(e=>e.replace("|","\\|")).join("|"),Pn=new RegExp(`(${Bn})$`),Hn=/[^a-z0-9!@#$%^&*:_+=<>|~.\x2D]/gi,Kn=/(\/\/[^\n\r]*)/,Gn=we("statebot.");function tn(e){let n=Gn("decomposeChart",{chart:kn},e);if(n)throw TypeError(n);let o=Yn(e),a=qn(o),m=a.map(Wn).flat(1).map(Zn).flat(1),_=!1,l=m.map(h=>(h.includes("")&&(_=!0),h.join(zt))),v=Qe(l),g=Qe(a.flat(3));return{transitions:v.map(h=>h.split(zt)),routes:v,states:_?g:g.filter(Boolean)}}function Jn(e){return[e].flat().reduce((n,o)=>[...n,...o.split(Un)],[])}function Yn(e){let n=Jn(e),o=[],a=!1,p=(_,l)=>{let v=l.replace(Kn,"").replace(Hn,"");return v?(a=Pn.test(v),a?_+v:(o.push(_+v),"")):_},m=n.reduce(p,"");return a||m?[...o,m]:[...o]}function qn(e){return e.map(n=>n.split(zt).map(o=>o.split(Ve)))}function Wn(e){let n=[];return e.reduce((o,a)=>o===!1?[...a]:(n.push([o,[...a]]),[...a]),!1),n}function Zn([e,n]){return e.reduce((o,a)=>[...o,...n.map(p=>[a,p])],[])}var en="onExiting",nn="onEntering",rn="onExited",on="onEntered",jt="onSwitching",Dt="onSwitched",Ut={[jt]:"(ANY)state:changing",[Dt]:"(ANY)state:changed"};function Te(e,n){if(!at(e))throw new TypeError(`
Statebot: Please specify a name for this machine`);let o=`Statebot[${e}]`;if(!Ot(n))throw new TypeError(`
${o}: Please specify options for this machine`);let{chart:a=void 0,logLevel:p=3,historyLimit:m=2}=n||{},_=n.events===void 0?me(Ze()):Fn(n.events)&&me(n.events);if(!_)throw new TypeError(`
${o}: Invalid event-emitter specified in options`);let{states:l=[],routes:v=[]}=a?tn(a):n,{startIn:g=l[0]}=n;if(!l.includes(g))throw new Error(`${o}: Starting-state not in chart: "${g}"`);let h=we(`${o}#`),T=Dn(p,console),{canWarn:S}=T,C=[g],$=Math.max(m,2),b=0,{pause:R,resume:w,paused:d,Pausable:r}=jn(!1,()=>T.warn(`${o}: Ignoring callback, paused`)),i=me(Ze()),c=r(i.emit);function u(O,A){return i.on(O,A),()=>i.off(O,A)}let M=Ee(e,"states","Listening for the following state-changes",[...l]),N=Ee(e,"transitions","Listening for the following transitions",[...v]),D=Ee(e,"events","Listening for the following events");function P(O,A){let F=ft(O)?O({enter:et,emit:X,Enter:tt,Emit:nt}):Ot(O)?O:null;if(!Ot(F))throw new TypeError(`Statebot[${e}]#${A}(): Expected an object, or a function that returns an object`);let j=[],B=[],{transitionsForEvents:I,transitionsOnly:ht}=Xn(F),yt=Object.entries(I).reduce(xt,{}),_t=sn(ht,S),Ft=Object.entries(yt).map(s).concat(_t.configs.map(kt)).flat();if(S()){j.push(..._t.states),B.push(..._t.routes);let f=j.filter(E=>!l.includes(E)),y=B.filter(E=>!v.includes(E));f.length&&T.warn(`Statebot[${e}]#${A}(): Invalid states specified:
`+f.map(E=>`  > "${E}"`).join(`
`)),y.length&&T.warn(`Statebot[${e}]#${A}(): Invalid transitions specified:
`+y.map(E=>`  > "${E}"`).join(`
`))}return()=>Ft.map(f=>f());function kt(f){let{fromState:y,toState:E,action:x}=f,k=`${y}->${E}`;return[N.increase(k),u(k,x)]}function xt(f,[y,E]){let{states:x,routes:k,configs:z}=sn(E,S);return S()&&(j.push(...x),B.push(...k)),{...f,[y]:z}}function t({fromState:f,toState:y,action:E,args:x}){return H(f,()=>(et(y,...x),ft(E)&&E(...x),!0))}function s([f,y]){return[D.increase(f),pt(f,(...E)=>{y.map(k=>({...k,args:E})).some(t)||lt(`Event not handled: "${f}"`)})]}}function W(){return C[C.length-2]}function U(){return C[C.length-1]}function Z(...O){let A=O.flat(),F=h("canTransitionTo",{state:at},A[0]);if(F)throw new TypeError(F);if(!A.length)return!1;let j=G();return A.every(B=>j.includes(B))}function G(O){let A=O!==void 0?O:U(),F=h("statesAvailableFromHere",{state:at},A);if(F)throw new TypeError(F);return v.reduce((j,B)=>{let[I,ht]=B.split(zt).map(yt=>yt.trim());return I===A?[...j,ht]:j},[])}function Y(O,A,...F){let j=U()===O;return A===void 0?j:j?ft(A)?A(...F):A:null}function J(O,...A){let F=Object.entries(O).find(([j])=>Y(j));return F?Y(...F.concat(A)):null}function H(...O){let A=h("inState",{state:[at,Ot]},O[0]);if(A)throw new TypeError(A);return Ot(O[0])?J(...O):Y(...O)}let X=r((O,...A)=>{let F=h("emit",{eventName:at},O);if(F)throw new TypeError(F);return _.emit(O,...A)}),et=r((O,...A)=>{let F=h("enter",{state:at},O);if(F)throw new TypeError(F);let j=U(),B=O;if(B===j)return lt(`Already in state: "${B}"`),!1;if(!l.includes(B))return lt(`Invalid state "${B}", not switching`),!1;let I=`${j}->${B}`;return v.includes(I)?(T.info(`${o}: tId<${++b}>: ${I}`),C.push(B),C.length>$&&C.shift(),c(Ut[jt],B,j,...A),c(I,...A),c(Ut[Dt],B,j,...A),!0):(lt(`Invalid transition "${I}", not switching`),!1)});function pt(O,A){let F=h("onEvent",{eventName:at,cb:ft},O,A);if(F)throw new TypeError(F);return _.on(O,A),()=>_.off(O,A)}let Q=Object.keys(Ut).reduce((O,A)=>({...O,[A]:F=>{let j=h(A,{cb:ft},F);if(j)throw new TypeError(j);let B=M.increase(Ut[A]),I=u(Ut[A],F);return()=>{I(),B()}}}),{}),V=[[en,jt],[nn,jt],[rn,Dt],[on,Dt]].reduce((O,A)=>{let[F,j]=A,B=F.slice(2),I=B.toLowerCase();return{...O,[F]:(ht,yt)=>{let _t=h(F,{state:at,cb:ft},ht,yt);if(_t)throw new TypeError(_t);let Ft=[M.increase(ht),M.increase(`${ht}:${I}`)],kt=Q[j]((xt,t,...s)=>{B.indexOf("Exit")===0?ht===t&&yt(xt,...s):ht===xt&&yt(t,...s)});return()=>{kt(),Ft.map(xt=>xt())}}}},{});function nt(O,...A){let F=h("Emit",{eventName:at},O);if(F)throw new TypeError(F);return(...j)=>X(O,...A,...j)}function tt(O,...A){let F=h("Enter",{state:at},O);if(F)throw new TypeError(F);return(...j)=>et(O,...A,...j)}function q(O,A,...F){return(...j)=>H(O,A,...F,...j)}function Rt(O,...A){return(...F)=>H(O,...A,...F)}function dt(...O){let A=h("InState",{state:[at,Ot]},O[0]);if(A)throw new TypeError(A);return Ot(O[0])?Rt(...O):q(...O)}function ct(){T.warn(`${o}: State-machine reset!`),C.length=0,C.push(g)}function lt(O){let A=W(),F=U(),j=`${A===void 0?"[undefined]":A}->${F}`,B=G();B.length?T.info(`${o}: ${O}
  > Previous transition: "${j}"
  > From "${F}", valid states are: [${B.map(I=>`"${I}"`).join(", ")}]`):T.info(`${o}: ${O}
  > Previous transition: "${j}"
  > There are no states available from "${F}"`)}function Et(){return{states:M.refs(),transitions:N.refs(),events:D.refs()}}function Nt(){T.log(`${o}: Information about this state-machine`),Tt(M),Tt(N),Tt(D)}function Tt(O){let{description:A,table:F}=O.toValue();T.log(A),F.length?T.table(F):T.log("  > No information")}return{__STATEBOT__:1,canTransitionTo:Z,currentState:U,emit:X,Emit:nt,enter:et,Enter:tt,history:()=>[...C],info:()=>Nt(),inspect:()=>Et(),inState:H,InState:dt,name:()=>e,onEntered:V[on],onEntering:V[nn],onEvent:pt,onExited:V[rn],onExiting:V[en],onSwitched:Q[Dt],onSwitching:Q[jt],onTransitions:O=>P(O,"onTransitions"),pause:R,paused:d,performTransitions:O=>P(O,"performTransitions"),previousState:W,reset:ct,resume:w,statesAvailableFromHere:G}}function Xn(e){let n={},o=[];return Object.entries(e).map(([a,p])=>{if(ft(p)){o.push({routeChart:a,action:p});return}if(!Ot(p))return;let{on:m,then:_}=p;if(at(m)||Xe(m)){[m].flat().map(g=>{n[g]=n[g]||[],n[g].push({routeChart:a,action:_})});return}ft(_)&&o.push({routeChart:a,action:p})}),{transitionsForEvents:n,transitionsOnly:o}}function sn(e,n){let o=[],a=[];return{configs:e.reduce((m,_)=>{let{routeChart:l,action:v}=_,{states:g,routes:h,transitions:T}=tn(l);return n()&&(o.push(...g),a.push(...h)),[...m,...T.map(([S,C])=>({fromState:S,toState:C,action:v}))]},[]),states:o,routes:a}}var sr=we("statebot.");(function(){if(typeof window.CustomEvent=="function")return!1;function e(n,o){o=o||{bubbles:!1,cancelable:!1,detail:null};let a=document.createEvent("CustomEvent");return a.initCustomEvent(n,o.bubbles,o.cancelable,o.detail),a}window.CustomEvent=e})();var Qt=function(){let e;try{e=window}catch(v){e=self}let n="message-bus",o=new Map;function a(v,...g){let h={eventName:v,args:g,timestamp:Date.now()},T=new CustomEvent(n,{detail:h});e.dispatchEvent(T)}function p(v,g){if(typeof g!="function")throw new TypeError("Callback is not a function");let h=o.has(v)?o.get(v):o.set(v,new Map).get(v);if(h.has(g))throw new Error("Callback already deals with this event");let T=typeof v=="string"&&v.indexOf("*")===-1,S=typeof v=="string"?_(v):v instanceof RegExp?v:null;if(S===null){let $="Could not figure-out eventNameOrPattern";throw new Error(`${$} = ${v}`)}let C=$=>{let{eventName:b,args:R}=$.detail;S.test(b)&&(T?g(...R):g(b,...R))};return h.set(g,C),e.addEventListener(n,C),()=>m(v,g)}function m(v,g){if(typeof g!="function")throw new TypeError("Callback is not a function");if(!o.has(v))throw new Error("No event-listener for that name/pattern");let h=o.get(v);if(!h.has(g))throw new Error("Event callback not found for name/pattern");let T=h.get(g);e.removeEventListener(n,T),h.delete(g)}function _(v){if(!v.length)throw new Error("String should not be empty");let g=v.split("*").map(T=>T.trim()).map(l),h=g.join(".*");return g.length===1?h=`^${h}$`:(g[0]!==""&&(h=`^${h}`),g[g.length-1]!==""&&(h=`${h}$`)),new RegExp(h)}function l(v){return v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return{emit:a,on:p,off:m}}();var an=function(){Qn();function e(n,o){let{rx:a,cb:p}=o;if(typeof p!="function")throw TypeError("Callback is not a function");window.addEventListener(n,m=>{let _=m.detail,l=_.url,v=!0;a instanceof RegExp?v=a.test(l):typeof a=="string"&&(v=a.indexOf(l)!==-1),v&&p(_)})}return function(n){let{name:o,description:a,rx:p,onBeforeOpen:m,onBeforeSend:_,onFullResponse:l}=n||{};console.info(`AjaxListener[${o}]: ${a}`),typeof m=="function"&&e("ajax:onBeforeOpen",{rx:p,cb:m}),typeof _=="function"&&e("ajax:onBeforeSend",{rx:p,cb:_}),typeof l=="function"&&e("ajax:onFullResponse",{rx:p,cb:l})}}();function un(e){let{name:n,description:o,method:a,url:p,setHeaders:m,setPayload:_}=e,l=(a||"get").toUpperCase(),v=(...T)=>{let S;return typeof _=="function"?S=_(...T):S=_,S||""},g=(...T)=>{let S;return typeof m=="function"?S=m(...T):S=m,S||{}};return(...T)=>{console.info(`AjaxRequester[${n}]: ${o}`);let S=g(...T),C=new XMLHttpRequest;C.open(l,p),Object.keys(S).forEach($=>{let b=S[$];$&&b&&C.setRequestHeader($,b)}),C.send(v(...T))}}function Qn(){function e(_,l){let v=new CustomEvent(_,{detail:l});window.dispatchEvent(v)}let n=window.XMLHttpRequest.prototype.open,o=window.XMLHttpRequest.prototype.send;function a(_,l,v=!0,g,h){return this._options={method:_,url:l,async:v,user:g,password:h,xhr:this},e("ajax:onBeforeOpen",this._options),n.apply(this,arguments)}function p(_){return this._options.data=_,this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),this.onreadystatechange=m,e("ajax:onBeforeSend",this._options),o.apply(this,arguments)}function m(){if(this.readyState===4&&(this._options.status=this.status,this._options.responseText=this.responseText,e("ajax:onFullResponse",this._options)),this._onreadystatechange)return this._onreadystatechange.apply(this,arguments)}window.XMLHttpRequest.prototype.open=a,window.XMLHttpRequest.prototype.send=p,console.log("attachAjaxEventRepeater")}var fn={FIRST_RUN:"first-run",STORE_HYDRATED:"ui/store-hydrated",STORE_UPDATED:"ui/store-updated",ui:{RENDERING:"ui/rendering",RENDERED:"ui/rendered",TOGGLE_OPEN:"ui/toggle-open",FIND_ACCOUNTS:"ui/find-accounts",FIND_STATEMENTS:"ui/find-statements",VIEW_STATEMENTS:"ui/view-statements",DOWNLOAD_STATEMENTS:"ui/download-statements",DOWNLOADED_STATEMENTS:"ui/downloaded-statements",UPDATE_PROGRESS_BAR:"ui/update-progress-bar",STATEMENTS_WINDOW_READY:"ui/statements-window-ready",STATEMENTS_WINDOW_CLOSED:"ui/statements-window-closed",CLOSE_STATEMENTS_WINDOW:"ui/close-statements-window",CHANGE_STATEMENT:"ui/change-statement"},get:{ACCOUNTS:"get/accounts",STATEMENTS:"get/statements",ENTRIES:"get/entries"},error:{ACCOUNTS:"error/accounts",STATEMENTS:"error/statements",ENTRIES:"error/entries"},got:{ACCOUNTS:"got/accounts",STATEMENTS:"got/statements",ENTRIES:"got/entries"},add:{ACCOUNTS:"add/accounts",STATEMENTS:"add/statements",ENTRIES:"add/entries"},update:{ACCOUNTS:"update/accounts",STATEMENTS:"update/statements",ENTRIES:"update/entries"}};Qt.on(fn.ui.RENDERING,e=>{e.Fragment={view:function(n){return n.children}}});var Vn=`

  // Happy path
  //
    [idle] -> getting-accounts ->
    [found-accounts] -> getting-statements ->
    [found-statements] -> getting-entries ->
    [found-entries]

  // Downloading Zip
  //
    found-entries -> [download-all] -> found-entries

  // Failures
  //
    (getting-accounts -> failed-accounts -> idle)
    (getting-statements -> failed-statements -> found-accounts)
    (getting-entries -> failed-entries -> found-statements)

`;tr(window.obis);function tr(e){e.deps={addAjaxListener:an,AjaxRequester:un,fflate:{zip:qe,strToU8:Xt},jmespath:hn.default,messages:Qt,saveAs:ln.saveAs,SparkMD5:cn.default,Statebot:Te},e.fetchMachine=Te("fetcher",{events:Qt,startIn:"idle",chart:Vn,logLevel:2});let{rootPath:n}=e,o=[`${n}/plugins.js`],a=[`${n}/ui.css`,`${n}/ui.js`];e.loadPlugin=_=>{e.plugin=_(),o.push(...a)},e.registerPlugins=_=>{_.find(p)||console.error("No plugin detected. Nothing to do.")};function p(_){let{name:l,description:v,urls:g}=_;if(g.some(T=>location.href.includes(T)))return console.log("Detected "+v+": Adding plugin"),o.push(`${n}/plugins/${l}.js`),!0}e.loadStyle=(_,l)=>{let v=document.createElement("link");v.href=_,v.rel="stylesheet",v.type="text/css",console.log("Loading: "+_),l instanceof Function&&(v.onload=()=>l(_,!0),v.onerror=()=>l(_,!1)),document.getElementsByTagName("head")[0].appendChild(v)};let m=()=>{if(!o.length){console.log("Done loading scripts");return}let _=o.shift();/\.css$/.test(_)?e.loadStyle(_,(l,v)=>{v?m():console.error("Could not load style: "+l)}):e.loadScript(_,(l,v)=>{v?m():console.error("Could not load script: "+l)})};m()}})();
