(()=>{var Wi=Object.create,Qt=Object.defineProperty,Ki=Object.getPrototypeOf,Ji=Object.prototype.hasOwnProperty,Xi=Object.getOwnPropertyNames,Qi=Object.getOwnPropertyDescriptor;var Zi=e=>Qt(e,"__esModule",{value:!0});var V=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports);var eo=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Xi(t))!Ji.call(e,r)&&r!=="default"&&Qt(e,r,{get:()=>t[r],enumerable:!(n=Qi(t,r))||n.enumerable});return e},Ce=e=>e&&e.__esModule?e:eo(Zi(Qt(e!=null?Wi(Ki(e)):{},"default",{value:e,enumerable:!0})),e);var _e=V((Qs,Hn)=>{"use strict";function Be(e,t,n,r,s,a){return{tag:e,key:t,attrs:n,children:r,text:s,dom:a,domSize:void 0,state:void 0,events:void 0,instance:void 0}}Be.normalize=function(e){return Array.isArray(e)?Be("[",void 0,void 0,Be.normalizeChildren(e),void 0,void 0):e==null||typeof e=="boolean"?null:typeof e=="object"?e:Be("#",void 0,void 0,String(e),void 0,void 0)};Be.normalizeChildren=function(e){var t=[];if(e.length){for(var n=e[0]!=null&&e[0].key!=null,r=1;r<e.length;r++)if((e[r]!=null&&e[r].key!=null)!==n)throw new TypeError("Vnodes must either always have keys or never have keys!");for(var r=0;r<e.length;r++)t[r]=Be.normalize(e[r])}return t};Hn.exports=Be});var Zt=V((Zs,Gn)=>{"use strict";var to=_e();Gn.exports=function(){var e=arguments[this],t=this+1,n;if(e==null?e={}:(typeof e!="object"||e.tag!=null||Array.isArray(e))&&(e={},t=this),arguments.length===t+1)n=arguments[t],Array.isArray(n)||(n=[n]);else for(n=[];t<arguments.length;)n.push(arguments[t++]);return to("",e.key,e,n)}});var en=V((ea,Vn)=>{"use strict";var Yn=_e(),no=Zt(),ro=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,Wn={},Xe={}.hasOwnProperty;function Kn(e){for(var t in e)if(Xe.call(e,t))return!1;return!0}function io(e){for(var t,n="div",r=[],s={};t=ro.exec(e);){var a=t[1],u=t[2];if(a===""&&u!=="")n=u;else if(a==="#")s.id=u;else if(a===".")r.push(u);else if(t[3][0]==="["){var f=t[6];f&&(f=f.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),t[4]==="class"?r.push(f):s[t[4]]=f===""?f:f||!0}}return r.length>0&&(s.className=r.join(" ")),Wn[e]={tag:n,attrs:s}}function oo(e,t){var n=t.attrs,r=Yn.normalizeChildren(t.children),s=Xe.call(n,"class"),a=s?n.class:n.className;if(t.tag=e.tag,t.attrs=null,t.children=void 0,!Kn(e.attrs)&&!Kn(n)){var u={};for(var f in n)Xe.call(n,f)&&(u[f]=n[f]);n=u}for(var f in e.attrs)Xe.call(e.attrs,f)&&f!=="className"&&!Xe.call(n,f)&&(n[f]=e.attrs[f]);(a!=null||e.attrs.className!=null)&&(n.className=a!=null?e.attrs.className!=null?String(e.attrs.className)+" "+String(a):a:e.attrs.className!=null?e.attrs.className:null),s&&(n.class=null);for(var f in n)if(Xe.call(n,f)&&f!=="key"){t.attrs=n;break}return Array.isArray(r)&&r.length===1&&r[0]!=null&&r[0].tag==="#"?t.text=r[0].children:t.children=r,t}function so(e){if(e==null||typeof e!="string"&&typeof e!="function"&&typeof e.view!="function")throw Error("The selector must be either a string or a component.");var t=no.apply(1,arguments);return typeof e=="string"&&(t.children=Yn.normalizeChildren(t.children),e!=="[")?oo(Wn[e]||io(e),t):(t.tag=e,t)}Vn.exports=so});var Xn=V((ta,Jn)=>{"use strict";var ao=_e();Jn.exports=function(e){return e==null&&(e=""),ao("<",void 0,void 0,e,void 0,void 0)}});var Zn=V((na,Qn)=>{"use strict";var co=_e(),uo=Zt();Qn.exports=function(){var e=uo.apply(0,arguments);return e.tag="[",e.children=co.normalizeChildren(e.children),e}});var tr=V((ra,er)=>{"use strict";var tn=en();tn.trust=Xn();tn.fragment=Zn();er.exports=tn});var nn=V((ia,nr)=>{"use strict";var oe=function(e){if(!(this instanceof oe))throw new Error("Promise must be called with `new`");if(typeof e!="function")throw new TypeError("executor must be a function");var t=this,n=[],r=[],s=l(n,!0),a=l(r,!1),u=t._instance={resolvers:n,rejectors:r},f=typeof setImmediate=="function"?setImmediate:setTimeout;function l(d,m){return function y(E){var b;try{if(m&&E!=null&&(typeof E=="object"||typeof E=="function")&&typeof(b=E.then)=="function"){if(E===t)throw new TypeError("Promise can't be resolved w/ itself");p(b.bind(E))}else f(function(){!m&&d.length===0&&console.error("Possible unhandled promise rejection:",E);for(var S=0;S<d.length;S++)d[S](E);n.length=0,r.length=0,u.state=m,u.retry=function(){y(E)}})}catch(S){a(S)}}}function p(d){var m=0;function y(b){return function(S){m++>0||b(S)}}var E=y(a);try{d(y(s),E)}catch(b){E(b)}}p(e)};oe.prototype.then=function(e,t){var n=this,r=n._instance;function s(l,p,d,m){p.push(function(y){if(typeof l!="function")d(y);else try{a(l(y))}catch(E){u&&u(E)}}),typeof r.retry=="function"&&m===r.state&&r.retry()}var a,u,f=new oe(function(l,p){a=l,u=p});return s(e,r.resolvers,a,!0),s(t,r.rejectors,u,!1),f};oe.prototype.catch=function(e){return this.then(null,e)};oe.prototype.finally=function(e){return this.then(function(t){return oe.resolve(e()).then(function(){return t})},function(t){return oe.resolve(e()).then(function(){return oe.reject(t)})})};oe.resolve=function(e){return e instanceof oe?e:new oe(function(t){t(e)})};oe.reject=function(e){return new oe(function(t,n){n(e)})};oe.all=function(e){return new oe(function(t,n){var r=e.length,s=0,a=[];if(e.length===0)t([]);else for(var u=0;u<e.length;u++)(function(f){function l(p){s++,a[f]=p,s===r&&t(a)}e[f]!=null&&(typeof e[f]=="object"||typeof e[f]=="function")&&typeof e[f].then=="function"?e[f].then(l,n):l(e[f])})(u)})};oe.race=function(e){return new oe(function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)})};nr.exports=oe});var rn=V((oa,It)=>{"use strict";var ft=nn();typeof window!="undefined"?(typeof window.Promise=="undefined"?window.Promise=ft:window.Promise.prototype.finally||(window.Promise.prototype.finally=ft.prototype.finally),It.exports=window.Promise):typeof global!="undefined"?(typeof global.Promise=="undefined"?global.Promise=ft:global.Promise.prototype.finally||(global.Promise.prototype.finally=ft.prototype.finally),It.exports=global.Promise):It.exports=ft});var ir=V((sa,rr)=>{"use strict";var Qe=_e();rr.exports=function(e){var t=e&&e.document,n,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function s(o){return o.attrs&&o.attrs.xmlns||r[o.tag]}function a(o,i){if(o.state!==i)throw new Error("`vnode.state` must not be modified")}function u(o){var i=o.state;try{return this.apply(i,arguments)}finally{a(o,i)}}function f(){try{return t.activeElement}catch(o){return null}}function l(o,i,c,h,g,T,C){for(var R=c;R<h;R++){var D=i[R];D!=null&&p(o,D,g,C,T)}}function p(o,i,c,h,g){var T=i.tag;if(typeof T=="string")switch(i.state={},i.attrs!=null&&x(i.attrs,i,c),T){case"#":d(o,i,g);break;case"<":y(o,i,h,g);break;case"[":E(o,i,c,h,g);break;default:b(o,i,c,h,g)}else A(o,i,c,h,g)}function d(o,i,c){i.dom=t.createTextNode(i.children),be(o,i.dom,c)}var m={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function y(o,i,c,h){var g=i.children.match(/^\s*?<(\w+)/im)||[],T=t.createElement(m[g[1]]||"div");c==="http://www.w3.org/2000/svg"?(T.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+i.children+"</svg>",T=T.firstChild):T.innerHTML=i.children,i.dom=T.firstChild,i.domSize=T.childNodes.length,i.instance=[];for(var C=t.createDocumentFragment(),R;R=T.firstChild;)i.instance.push(R),C.appendChild(R);be(o,C,h)}function E(o,i,c,h,g){var T=t.createDocumentFragment();if(i.children!=null){var C=i.children;l(T,C,0,C.length,c,null,h)}i.dom=T.firstChild,i.domSize=T.childNodes.length,be(o,T,g)}function b(o,i,c,h,g){var T=i.tag,C=i.attrs,R=C&&C.is;h=s(i)||h;var D=h?R?t.createElementNS(h,T,{is:R}):t.createElementNS(h,T):R?t.createElement(T,{is:R}):t.createElement(T);if(i.dom=D,C!=null&&st(i,C,h),be(o,D,g),!Se(i)&&(i.text!=null&&(i.text!==""?D.textContent=i.text:i.children=[Qe("#",void 0,void 0,i.text,void 0,void 0)]),i.children!=null)){var I=i.children;l(D,I,0,I.length,c,null,h),i.tag==="select"&&C!=null&&xt(i,C)}}function S(o,i){var c;if(typeof o.tag.view=="function"){if(o.state=Object.create(o.tag),c=o.state.view,c.$$reentrantLock$$!=null)return;c.$$reentrantLock$$=!0}else{if(o.state=void 0,c=o.tag,c.$$reentrantLock$$!=null)return;c.$$reentrantLock$$=!0,o.state=o.tag.prototype!=null&&typeof o.tag.prototype.view=="function"?new o.tag(o):o.tag(o)}if(x(o.state,o,i),o.attrs!=null&&x(o.attrs,o,i),o.instance=Qe.normalize(u.call(o.state.view,o)),o.instance===o)throw Error("A view cannot return the vnode it received as argument");c.$$reentrantLock$$=null}function A(o,i,c,h,g){S(i,c),i.instance!=null?(p(o,i.instance,c,h,g),i.dom=i.instance.dom,i.domSize=i.dom!=null?i.instance.domSize:0):i.domSize=0}function O(o,i,c,h,g,T){if(!(i===c||i==null&&c==null))if(i==null||i.length===0)l(o,c,0,c.length,h,g,T);else if(c==null||c.length===0)F(o,i,0,i.length);else{var C=i[0]!=null&&i[0].key!=null,R=c[0]!=null&&c[0].key!=null,D=0,I=0;if(!C)for(;I<i.length&&i[I]==null;)I++;if(!R)for(;D<c.length&&c[D]==null;)D++;if(R===null&&C==null)return;if(C!==R)F(o,i,I,i.length),l(o,c,D,c.length,h,g,T);else if(R){for(var k=i.length-1,H=c.length-1,xe,ae,Q,de,Y,Yt;k>=I&&H>=D&&(de=i[k],Y=c[H],de.key===Y.key);)de!==Y&&$(o,de,Y,h,g,T),Y.dom!=null&&(g=Y.dom),k--,H--;for(;k>=I&&H>=D&&(ae=i[I],Q=c[D],ae.key===Q.key);)I++,D++,ae!==Q&&$(o,ae,Q,h,pe(i,I,g),T);for(;k>=I&&H>=D&&!(D===H||ae.key!==Y.key||de.key!==Q.key);)Yt=pe(i,I,g),ee(o,de,Yt),de!==Q&&$(o,de,Q,h,Yt,T),++D<=--H&&ee(o,ae,g),ae!==Y&&$(o,ae,Y,h,g,T),Y.dom!=null&&(g=Y.dom),I++,k--,de=i[k],Y=c[H],ae=i[I],Q=c[D];for(;k>=I&&H>=D&&de.key===Y.key;)de!==Y&&$(o,de,Y,h,g,T),Y.dom!=null&&(g=Y.dom),k--,H--,de=i[k],Y=c[H];if(D>H)F(o,i,I,k+1);else if(I>k)l(o,c,D,H+1,h,g,T);else{var Yi=g,zn=H-D+1,ut=new Array(zn),Wt=0,K=0,Kt=2147483647,Jt=0,xe,Xt;for(K=0;K<zn;K++)ut[K]=-1;for(K=H;K>=D;K--){xe==null&&(xe=se(i,I,k+1)),Y=c[K];var Je=xe[Y.key];Je!=null&&(Kt=Je<Kt?Je:-1,ut[K-D]=Je,de=i[Je],i[Je]=null,de!==Y&&$(o,de,Y,h,g,T),Y.dom!=null&&(g=Y.dom),Jt++)}if(g=Yi,Jt!==k-I+1&&F(o,i,I,k+1),Jt===0)l(o,c,D,H+1,h,g,T);else if(Kt===-1)for(Xt=Ae(ut),Wt=Xt.length-1,K=H;K>=D;K--)Q=c[K],ut[K-D]===-1?p(o,Q,h,T,g):Xt[Wt]===K-D?Wt--:ee(o,Q,g),Q.dom!=null&&(g=c[K].dom);else for(K=H;K>=D;K--)Q=c[K],ut[K-D]===-1&&p(o,Q,h,T,g),Q.dom!=null&&(g=c[K].dom)}}else{var he=i.length<c.length?i.length:c.length;for(D=D<I?D:I;D<he;D++)ae=i[D],Q=c[D],!(ae===Q||ae==null&&Q==null)&&(ae==null?p(o,Q,h,T,pe(i,D+1,g)):Q==null?X(o,ae):$(o,ae,Q,h,pe(i,D+1,g),T));i.length>he&&F(o,i,D,i.length),c.length>he&&l(o,c,D,c.length,h,g,T)}}}function $(o,i,c,h,g,T){var C=i.tag,R=c.tag;if(C===R){if(c.state=i.state,c.events=i.events,z(c,i))return;if(typeof C=="string")switch(c.attrs!=null&&M(c.attrs,c,h),C){case"#":J(i,c);break;case"<":ne(o,i,c,T,g);break;case"[":B(o,i,c,h,g,T);break;default:_(i,c,h,T)}else U(o,i,c,h,g,T)}else X(o,i),p(o,c,h,T,g)}function J(o,i){o.children.toString()!==i.children.toString()&&(o.dom.nodeValue=i.children),i.dom=o.dom}function ne(o,i,c,h,g){i.children!==c.children?(je(o,i),y(o,c,h,g)):(c.dom=i.dom,c.domSize=i.domSize,c.instance=i.instance)}function B(o,i,c,h,g,T){O(o,i.children,c.children,h,g,T);var C=0,R=c.children;if(c.dom=null,R!=null){for(var D=0;D<R.length;D++){var I=R[D];I!=null&&I.dom!=null&&(c.dom==null&&(c.dom=I.dom),C+=I.domSize||1)}C!==1&&(c.domSize=C)}}function _(o,i,c,h){var g=i.dom=o.dom;h=s(i)||h,i.tag==="textarea"&&(i.attrs==null&&(i.attrs={}),i.text!=null&&(i.attrs.value=i.text,i.text=void 0)),Ht(i,o.attrs,i.attrs,h),Se(i)||(o.text!=null&&i.text!=null&&i.text!==""?o.text.toString()!==i.text.toString()&&(o.dom.firstChild.nodeValue=i.text):(o.text!=null&&(o.children=[Qe("#",void 0,void 0,o.text,void 0,o.dom.firstChild)]),i.text!=null&&(i.children=[Qe("#",void 0,void 0,i.text,void 0,void 0)]),O(g,o.children,i.children,c,null,h)))}function U(o,i,c,h,g,T){if(c.instance=Qe.normalize(u.call(c.state.view,c)),c.instance===c)throw Error("A view cannot return the vnode it received as argument");M(c.state,c,h),c.attrs!=null&&M(c.attrs,c,h),c.instance!=null?(i.instance==null?p(o,c.instance,h,T,g):$(o,i.instance,c.instance,h,g,T),c.dom=c.instance.dom,c.domSize=c.instance.domSize):i.instance!=null?(X(o,i.instance),c.dom=void 0,c.domSize=0):(c.dom=i.dom,c.domSize=i.domSize)}function se(o,i,c){for(var h=Object.create(null);i<c;i++){var g=o[i];if(g!=null){var T=g.key;T!=null&&(h[T]=i)}}return h}var W=[];function Ae(o){for(var i=[0],c=0,h=0,g=0,T=W.length=o.length,g=0;g<T;g++)W[g]=o[g];for(var g=0;g<T;++g)if(o[g]!==-1){var C=i[i.length-1];if(o[C]<o[g]){W[g]=C,i.push(g);continue}for(c=0,h=i.length-1;c<h;){var R=(c>>>1)+(h>>>1)+(c&h&1);o[i[R]]<o[g]?c=R+1:h=R}o[g]<o[i[c]]&&(c>0&&(W[g]=i[c-1]),i[c]=g)}for(c=i.length,h=i[c-1];c-- >0;)i[c]=h,h=W[h];return W.length=0,i}function pe(o,i,c){for(;i<o.length;i++)if(o[i]!=null&&o[i].dom!=null)return o[i].dom;return c}function ee(o,i,c){var h=t.createDocumentFragment();$e(o,h,i),be(o,h,c)}function $e(o,i,c){for(;c.dom!=null&&c.dom.parentNode===o;){if(typeof c.tag!="string"){if(c=c.instance,c!=null)continue}else if(c.tag==="<")for(var h=0;h<c.instance.length;h++)i.appendChild(c.instance[h]);else if(c.tag!=="[")i.appendChild(c.dom);else if(c.children.length===1){if(c=c.children[0],c!=null)continue}else for(var h=0;h<c.children.length;h++){var g=c.children[h];g!=null&&$e(o,i,g)}break}}function be(o,i,c){c!=null?o.insertBefore(i,c):o.appendChild(i)}function Se(o){if(o.attrs==null||o.attrs.contenteditable==null&&o.attrs.contentEditable==null)return!1;var i=o.children;if(i!=null&&i.length===1&&i[0].tag==="<"){var c=i[0].children;o.dom.innerHTML!==c&&(o.dom.innerHTML=c)}else if(o.text!=null||i!=null&&i.length!==0)throw new Error("Child node of a contenteditable must be trusted");return!0}function F(o,i,c,h){for(var g=c;g<h;g++){var T=i[g];T!=null&&X(o,T)}}function X(o,i){var c=0,h=i.state,g,T;if(typeof i.tag!="string"&&typeof i.state.onbeforeremove=="function"){var C=u.call(i.state.onbeforeremove,i);C!=null&&typeof C.then=="function"&&(c=1,g=C)}if(i.attrs&&typeof i.attrs.onbeforeremove=="function"){var C=u.call(i.attrs.onbeforeremove,i);C!=null&&typeof C.then=="function"&&(c|=2,T=C)}if(a(i,h),!c)Te(i),Pe(o,i);else{if(g!=null){var R=function(){c&1&&(c&=2,c||D())};g.then(R,R)}if(T!=null){var R=function(){c&2&&(c&=1,c||D())};T.then(R,R)}}function D(){a(i,h),Te(i),Pe(o,i)}}function je(o,i){for(var c=0;c<i.instance.length;c++)o.removeChild(i.instance[c])}function Pe(o,i){for(;i.dom!=null&&i.dom.parentNode===o;){if(typeof i.tag!="string"){if(i=i.instance,i!=null)continue}else if(i.tag==="<")je(o,i);else{if(i.tag!=="["&&(o.removeChild(i.dom),!Array.isArray(i.children)))break;if(i.children.length===1){if(i=i.children[0],i!=null)continue}else for(var c=0;c<i.children.length;c++){var h=i.children[c];h!=null&&Pe(o,h)}}break}}function Te(o){if(typeof o.tag!="string"&&typeof o.state.onremove=="function"&&u.call(o.state.onremove,o),o.attrs&&typeof o.attrs.onremove=="function"&&u.call(o.attrs.onremove,o),typeof o.tag!="string")o.instance!=null&&Te(o.instance);else{var i=o.children;if(Array.isArray(i))for(var c=0;c<i.length;c++){var h=i[c];h!=null&&Te(h)}}}function st(o,i,c){for(var h in i)Fe(o,h,null,i[h],c)}function Fe(o,i,c,h,g){if(!(i==="key"||i==="is"||h==null||at(i)||c===h&&!Gt(o,i)&&typeof h!="object")){if(i[0]==="o"&&i[1]==="n")return N(o,i,h);if(i.slice(0,6)==="xlink:")o.dom.setAttributeNS("http://www.w3.org/1999/xlink",i.slice(6),h);else if(i==="style")Ke(o.dom,c,h);else if(Ct(o,i,g)){if(i==="value"&&((o.tag==="input"||o.tag==="textarea")&&o.dom.value===""+h&&o.dom===f()||o.tag==="select"&&c!==null&&o.dom.value===""+h||o.tag==="option"&&c!==null&&o.dom.value===""+h))return;o.tag==="input"&&i==="type"?o.dom.setAttribute(i,h):o.dom[i]=h}else typeof h=="boolean"?h?o.dom.setAttribute(i,""):o.dom.removeAttribute(i):o.dom.setAttribute(i==="className"?"class":i,h)}}function Ot(o,i,c,h){if(!(i==="key"||i==="is"||c==null||at(i)))if(i[0]==="o"&&i[1]==="n"&&!at(i))N(o,i,void 0);else if(i==="style")Ke(o.dom,c,null);else if(Ct(o,i,h)&&i!=="className"&&!(i==="value"&&(o.tag==="option"||o.tag==="select"&&o.dom.selectedIndex===-1&&o.dom===f()))&&!(o.tag==="input"&&i==="type"))o.dom[i]=null;else{var g=i.indexOf(":");g!==-1&&(i=i.slice(g+1)),c!==!1&&o.dom.removeAttribute(i==="className"?"class":i)}}function xt(o,i){if("value"in i)if(i.value===null)o.dom.selectedIndex!==-1&&(o.dom.value=null);else{var c=""+i.value;(o.dom.value!==c||o.dom.selectedIndex===-1)&&(o.dom.value=c)}"selectedIndex"in i&&Fe(o,"selectedIndex",null,i.selectedIndex,void 0)}function Ht(o,i,c,h){if(c!=null)for(var g in c)Fe(o,g,i&&i[g],c[g],h);var T;if(i!=null)for(var g in i)(T=i[g])!=null&&(c==null||c[g]==null)&&Ot(o,g,T,h)}function Gt(o,i){return i==="value"||i==="checked"||i==="selectedIndex"||i==="selected"&&o.dom===f()||o.tag==="option"&&o.dom.parentNode===t.activeElement}function at(o){return o==="oninit"||o==="oncreate"||o==="onupdate"||o==="onremove"||o==="onbeforeremove"||o==="onbeforeupdate"}function Ct(o,i,c){return c===void 0&&(o.tag.indexOf("-")>-1||o.attrs!=null&&o.attrs.is||i!=="href"&&i!=="list"&&i!=="form"&&i!=="width"&&i!=="height")&&i in o.dom}var We=/[A-Z]/g;function Vt(o){return"-"+o.toLowerCase()}function ct(o){return o[0]==="-"&&o[1]==="-"?o:o==="cssFloat"?"float":o.replace(We,Vt)}function Ke(o,i,c){if(i!==c)if(c==null)o.style.cssText="";else if(typeof c!="object")o.style.cssText=c;else if(i==null||typeof i!="object"){o.style.cssText="";for(var h in c){var g=c[h];g!=null&&o.style.setProperty(ct(h),String(g))}}else{for(var h in c){var g=c[h];g!=null&&(g=String(g))!==String(i[h])&&o.style.setProperty(ct(h),g)}for(var h in i)i[h]!=null&&c[h]==null&&o.style.removeProperty(ct(h))}}function v(){this._=n}v.prototype=Object.create(null),v.prototype.handleEvent=function(o){var i=this["on"+o.type],c;typeof i=="function"?c=i.call(o.currentTarget,o):typeof i.handleEvent=="function"&&i.handleEvent(o),this._&&o.redraw!==!1&&(0,this._)(),c===!1&&(o.preventDefault(),o.stopPropagation())};function N(o,i,c){if(o.events!=null){if(o.events[i]===c)return;c!=null&&(typeof c=="function"||typeof c=="object")?(o.events[i]==null&&o.dom.addEventListener(i.slice(2),o.events,!1),o.events[i]=c):(o.events[i]!=null&&o.dom.removeEventListener(i.slice(2),o.events,!1),o.events[i]=void 0)}else c!=null&&(typeof c=="function"||typeof c=="object")&&(o.events=new v,o.dom.addEventListener(i.slice(2),o.events,!1),o.events[i]=c)}function x(o,i,c){typeof o.oninit=="function"&&u.call(o.oninit,i),typeof o.oncreate=="function"&&c.push(u.bind(o.oncreate,i))}function M(o,i,c){typeof o.onupdate=="function"&&c.push(u.bind(o.onupdate,i))}function z(o,i){do{if(o.attrs!=null&&typeof o.attrs.onbeforeupdate=="function"){var c=u.call(o.attrs.onbeforeupdate,o,i);if(c!==void 0&&!c)break}if(typeof o.tag!="string"&&typeof o.state.onbeforeupdate=="function"){var c=u.call(o.state.onbeforeupdate,o,i);if(c!==void 0&&!c)break}return!1}while(!1);return o.dom=i.dom,o.domSize=i.domSize,o.instance=i.instance,o.attrs=i.attrs,o.children=i.children,o.text=i.text,!0}return function(o,i,c){if(!o)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var h=[],g=f(),T=o.namespaceURI;o.vnodes==null&&(o.textContent=""),i=Qe.normalizeChildren(Array.isArray(i)?i:[i]);var C=n;try{n=typeof c=="function"?c:void 0,O(o,o.vnodes,i,h,null,T==="http://www.w3.org/1999/xhtml"?void 0:T)}finally{n=C}o.vnodes=i,g!=null&&f()!==g&&typeof g.focus=="function"&&g.focus();for(var R=0;R<h.length;R++)h[R]()}}});var on=V((aa,or)=>{"use strict";or.exports=ir()(window)});var cr=V((ca,sr)=>{"use strict";var ar=_e();sr.exports=function(e,t,n){var r=[],s=!1,a=!1;function u(){if(s)throw new Error("Nested m.redraw.sync() call");s=!0;for(var p=0;p<r.length;p+=2)try{e(r[p],ar(r[p+1]),f)}catch(d){n.error(d)}s=!1}function f(){a||(a=!0,t(function(){a=!1,u()}))}f.sync=u;function l(p,d){if(d!=null&&d.view==null&&typeof d!="function")throw new TypeError("m.mount(element, component) expects a component, not a vnode");var m=r.indexOf(p);m>=0&&(r.splice(m,2),e(p,[],f)),d!=null&&(r.push(p,d),e(p,ar(d),f))}return{mount:l,redraw:f}}});var Rt=V((ua,ur)=>{"use strict";var fo=on();ur.exports=cr()(fo,requestAnimationFrame,console)});var sn=V((fa,fr)=>{"use strict";fr.exports=function(e){if(Object.prototype.toString.call(e)!=="[object Object]")return"";var t=[];for(var n in e)r(n,e[n]);return t.join("&");function r(s,a){if(Array.isArray(a))for(var u=0;u<a.length;u++)r(s+"["+u+"]",a[u]);else if(Object.prototype.toString.call(a)==="[object Object]")for(var u in a)r(s+"["+u+"]",a[u]);else t.push(encodeURIComponent(s)+(a!=null&&a!==""?"="+encodeURIComponent(a):""))}}});var an=V((la,lr)=>{"use strict";lr.exports=Object.assign||function(e,t){t&&Object.keys(t).forEach(function(n){e[n]=t[n]})}});var Pt=V((pa,pr)=>{"use strict";var lo=sn(),po=an();pr.exports=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names *must* be separated");if(t==null)return e;var n=e.indexOf("?"),r=e.indexOf("#"),s=r<0?e.length:r,a=n<0?s:n,u=e.slice(0,a),f={};po(f,t);var l=u.replace(/:([^\/\.-]+)(\.{3})?/g,function(S,A,O){return delete f[A],t[A]==null?S:O?t[A]:encodeURIComponent(String(t[A]))}),p=l.indexOf("?"),d=l.indexOf("#"),m=d<0?l.length:d,y=p<0?m:p,E=l.slice(0,y);n>=0&&(E+=e.slice(n,s)),p>=0&&(E+=(n<0?"?":"&")+l.slice(p,m));var b=lo(f);return b&&(E+=(n<0&&p<0?"?":"&")+b),r>=0&&(E+=e.slice(r)),d>=0&&(E+=(r<0?"":"&")+l.slice(d)),E}});var mr=V((da,dr)=>{"use strict";var mo=Pt();dr.exports=function(e,t,n){var r=0;function s(f){return new t(f)}s.prototype=t.prototype,s.__proto__=t;function a(f){return function(l,p){typeof l!="string"?(p=l,l=l.url):p==null&&(p={});var d=new t(function(b,S){f(mo(l,p.params),p,function(A){if(typeof p.type=="function")if(Array.isArray(A))for(var O=0;O<A.length;O++)A[O]=new p.type(A[O]);else A=new p.type(A);b(A)},S)});if(p.background===!0)return d;var m=0;function y(){--m==0&&typeof n=="function"&&n()}return E(d);function E(b){var S=b.then;return b.constructor=s,b.then=function(){m++;var A=S.apply(b,arguments);return A.then(y,function(O){if(y(),m===0)throw O}),E(A)},b}}}function u(f,l){for(var p in f.headers)if({}.hasOwnProperty.call(f.headers,p)&&l.test(p))return!0;return!1}return{request:a(function(f,l,p,d){var m=l.method!=null?l.method.toUpperCase():"GET",y=l.body,E=(l.serialize==null||l.serialize===JSON.serialize)&&!(y instanceof e.FormData),b=l.responseType||(typeof l.extract=="function"?"":"json"),S=new e.XMLHttpRequest,A=!1,O=S,$,J=S.abort;S.abort=function(){A=!0,J.call(this)},S.open(m,f,l.async!==!1,typeof l.user=="string"?l.user:void 0,typeof l.password=="string"?l.password:void 0),E&&y!=null&&!u(l,/^content-type$/i)&&S.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof l.deserialize!="function"&&!u(l,/^accept$/i)&&S.setRequestHeader("Accept","application/json, text/*"),l.withCredentials&&(S.withCredentials=l.withCredentials),l.timeout&&(S.timeout=l.timeout),S.responseType=b;for(var ne in l.headers)({}).hasOwnProperty.call(l.headers,ne)&&S.setRequestHeader(ne,l.headers[ne]);S.onreadystatechange=function(B){if(!A&&B.target.readyState===4)try{var _=B.target.status>=200&&B.target.status<300||B.target.status===304||/^file:\/\//i.test(f),U=B.target.response,se;if(b==="json"?!B.target.responseType&&typeof l.extract!="function"&&(U=JSON.parse(B.target.responseText)):(!b||b==="text")&&U==null&&(U=B.target.responseText),typeof l.extract=="function"?(U=l.extract(B.target,l),_=!0):typeof l.deserialize=="function"&&(U=l.deserialize(U)),_)p(U);else{try{se=B.target.responseText}catch(Ae){se=U}var W=new Error(se);W.code=B.target.status,W.response=U,d(W)}}catch(Ae){d(Ae)}},typeof l.config=="function"&&(S=l.config(S,l,f)||S,S!==O&&($=S.abort,S.abort=function(){A=!0,$.call(this)})),y==null?S.send():typeof l.serialize=="function"?S.send(l.serialize(y)):y instanceof e.FormData?S.send(y):S.send(JSON.stringify(y))}),jsonp:a(function(f,l,p,d){var m=l.callbackName||"_mithril_"+Math.round(Math.random()*1e16)+"_"+r++,y=e.document.createElement("script");e[m]=function(E){delete e[m],y.parentNode.removeChild(y),p(E)},y.onerror=function(){delete e[m],y.parentNode.removeChild(y),d(new Error("JSONP request failed"))},y.src=f+(f.indexOf("?")<0?"?":"&")+encodeURIComponent(l.callbackKey||"callback")+"="+encodeURIComponent(m),e.document.documentElement.appendChild(y)})}}});var gr=V((ma,hr)=>{"use strict";var ho=rn(),go=Rt();hr.exports=mr()(window,ho,go.redraw)});var cn=V((ha,yr)=>{"use strict";yr.exports=function(e){if(e===""||e==null)return{};e.charAt(0)==="?"&&(e=e.slice(1));for(var t=e.split("&"),n={},r={},s=0;s<t.length;s++){var a=t[s].split("="),u=decodeURIComponent(a[0]),f=a.length===2?decodeURIComponent(a[1]):"";f==="true"?f=!0:f==="false"&&(f=!1);var l=u.split(/\]\[?|\[/),p=r;u.indexOf("[")>-1&&l.pop();for(var d=0;d<l.length;d++){var m=l[d],y=l[d+1],E=y==""||!isNaN(parseInt(y,10));if(m===""){var u=l.slice(0,d).join();n[u]==null&&(n[u]=Array.isArray(p)?p.length:0),m=n[u]++}else if(m==="__proto__")break;if(d===l.length-1)p[m]=f;else{var b=Object.getOwnPropertyDescriptor(p,m);b!=null&&(b=b.value),b==null&&(p[m]=b=E?[]:{}),p=b}}}return r}});var Mt=V((ga,Er)=>{"use strict";var yo=cn();Er.exports=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),r=n<0?e.length:n,s=t<0?r:t,a=e.slice(0,s).replace(/\/{2,}/g,"/");return a?(a[0]!=="/"&&(a="/"+a),a.length>1&&a[a.length-1]==="/"&&(a=a.slice(0,-1))):a="/",{path:a,params:t<0?{}:yo(e.slice(t+1,r))}}});var Sr=V((ya,br)=>{"use strict";var Eo=Mt();br.exports=function(e){var t=Eo(e),n=Object.keys(t.params),r=[],s=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(a,u,f){return u==null?"\\"+a:(r.push({k:u,r:f==="..."}),f==="..."?"(.*)":f==="."?"([^/]+)\\.":"([^/]+)"+(f||""))})+"$");return function(a){for(var u=0;u<n.length;u++)if(t.params[n[u]]!==a.params[n[u]])return!1;if(!r.length)return s.test(a.path);var f=s.exec(a.path);if(f==null)return!1;for(var u=0;u<r.length;u++)a.params[r[u].k]=r[u].r?f[u+1]:decodeURIComponent(f[u+1]);return!0}}});var Nr=V((Ea,Tr)=>{"use strict";var bo=_e(),So=en(),To=rn(),wo=Pt(),wr=Mt(),vo=Sr(),vr=an(),un={};Tr.exports=function(e,t){var n;function r(m,y,E){if(m=wo(m,y),n!=null){n();var b=E?E.state:null,S=E?E.title:null;E&&E.replace?e.history.replaceState(b,S,d.prefix+m):e.history.pushState(b,S,d.prefix+m)}else e.location.href=d.prefix+m}var s=un,a,u,f,l,p=d.SKIP={};function d(m,y,E){if(m==null)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var b=0,S=Object.keys(E).map(function(_){if(_[0]!=="/")throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(_))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:_,component:E[_],check:vo(_)}}),A=typeof setImmediate=="function"?setImmediate:setTimeout,O=To.resolve(),$=!1,J;if(n=null,y!=null){var ne=wr(y);if(!S.some(function(_){return _.check(ne)}))throw new ReferenceError("Default route doesn't match any known routes")}function B(){$=!1;var _=e.location.hash;d.prefix[0]!=="#"&&(_=e.location.search+_,d.prefix[0]!=="?"&&(_=e.location.pathname+_,_[0]!=="/"&&(_="/"+_)));var U=_.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(d.prefix.length),se=wr(U);vr(se.params,e.history.state);function W(){if(U===y)throw new Error("Could not resolve default route "+y);r(y,null,{replace:!0})}Ae(0);function Ae(pe){for(;pe<S.length;pe++)if(S[pe].check(se)){var ee=S[pe].component,$e=S[pe].route,be=ee,Se=l=function(F){if(Se===l){if(F===p)return Ae(pe+1);a=F!=null&&(typeof F.view=="function"||typeof F=="function")?F:"div",u=se.params,f=U,l=null,s=ee.render?ee:null,b===2?t.redraw():(b=2,t.redraw.sync())}};ee.view||typeof ee=="function"?(ee={},Se(be)):ee.onmatch?O.then(function(){return ee.onmatch(se.params,U,$e)}).then(Se,W):Se("div");return}W()}}return n=function(){$||($=!0,A(B))},typeof e.history.pushState=="function"?(J=function(){e.removeEventListener("popstate",n,!1)},e.addEventListener("popstate",n,!1)):d.prefix[0]==="#"&&(n=null,J=function(){e.removeEventListener("hashchange",B,!1)},e.addEventListener("hashchange",B,!1)),t.mount(m,{onbeforeupdate:function(){return b=b?2:1,!(!b||un===s)},oncreate:B,onremove:J,view:function(){if(!(!b||un===s)){var _=[bo(a,u.key,u)];return s&&(_=s.render(_[0])),_}}})}return d.set=function(m,y,E){l!=null&&(E=E||{},E.replace=!0),l=null,r(m,y,E)},d.get=function(){return f},d.prefix="#!",d.Link={view:function(m){var y=m.attrs.options,E={},b,S;vr(E,m.attrs),E.selector=E.options=E.key=E.oninit=E.oncreate=E.onbeforeupdate=E.onupdate=E.onbeforeremove=E.onremove=null;var A=So(m.attrs.selector||"a",E,m.children);return(A.attrs.disabled=Boolean(A.attrs.disabled))?(A.attrs.href=null,A.attrs["aria-disabled"]="true",A.attrs.onclick=null):(b=A.attrs.onclick,S=A.attrs.href,A.attrs.href=d.prefix+S,A.attrs.onclick=function(O){var $;typeof b=="function"?$=b.call(O.currentTarget,O):b==null||typeof b!="object"||typeof b.handleEvent=="function"&&b.handleEvent(O),$!==!1&&!O.defaultPrevented&&(O.button===0||O.which===0||O.which===1)&&(!O.currentTarget.target||O.currentTarget.target==="_self")&&!O.ctrlKey&&!O.metaKey&&!O.shiftKey&&!O.altKey&&(O.preventDefault(),O.redraw=!1,d.set(S,null,y))}),A}},d.param=function(m){return u&&m!=null?u[m]:u},d}});var Dr=V((ba,Ar)=>{"use strict";var No=Rt();Ar.exports=Nr()(window,No)});var ze=V((Sa,Or)=>{"use strict";var _t=tr(),xr=gr(),Cr=Rt(),me=function(){return _t.apply(this,arguments)};me.m=_t;me.trust=_t.trust;me.fragment=_t.fragment;me.mount=Cr.mount;me.route=Dr();me.render=on();me.redraw=Cr.redraw;me.request=xr.request;me.jsonp=xr.jsonp;me.parseQueryString=cn();me.buildQueryString=sn();me.parsePathname=Mt();me.buildPathname=Pt();me.vnode=_e();me.PromisePolyfill=nn();Or.exports=me});var lt=V((wa,Ir)=>{Ir.exports={seconds:Ao,makeDebouncer:kt,makeThrottler:Oo,runAfter:xo,runOnce:Co,runFnPeriodically:Rr,makeValueChangeDetector:fn,makeValueInPredicateDetector:Io,runFnWhenValueChanges:Ro,Delay:Do};function Ao(e){return e*1e3}function Do(e,t){let[n]=kt(t,e);return(...r)=>n(...r)}function kt(e,t){let n,r=()=>clearTimeout(n);return[(...a)=>{r(),n=setTimeout(t,e,...a)},r]}function Oo(e,t){let n=!0,[r,s]=kt(t,()=>n=!0);return[(...u)=>{n&&(n=!1,r(),e(...u))},s]}function xo(e,t){let[n,r]=kt(e,t);return n(),r}function Co(e){let t=!0,n=()=>!0,r=(...s)=>{t&&n()&&(t=!1,e(...s))};return r.when=s=>(n=s,r),r}function Rr(e,t=16){let n=()=>clearInterval(r),r=setInterval(e,t,{cleanup:n});return n}function fn({onChange:e=()=>{},getValueFn:t=()=>NaN,equalityFn:n=(r,s)=>r===s}){let r=t();return(...a)=>{let u=t();if(!n(u,r)){let f=r;r=u,e(u,f,...a)}}}function Io({onChange:e=()=>{},getValueFn:t=()=>NaN,predicateFn:n=()=>!0}){return fn({getValueFn:t,onChange:s=>n(s)&&e()})}function Ro({fn:e,getValueFn:t}){let n=fn({getValueFn:t,onChange:e});return Rr(n,16)}});var ln=V((va,Pr)=>{Pr.exports={isThennable:Mo,makePromise:pt,delay:_o,unzip:Po,makeIdleDetectorWithTimeout:ko,poolPromises:$o,runPromisesInSequence:jo};var{seconds:Fo,runOnce:Lo,makeDebouncer:Mr}=lt();function _r(){return[(e,[t,n])=>[[...e[0],t],[...e[1],n]],[[],[]]]}function Po(e){return e.reduce(..._r())}function Mo(e){return e&&typeof e.then=="function"}function pt(){let e,t;return[new Promise((r,s)=>{e=r,t=s}),e,t]}function _o(e){let[t,n]=pt();return setTimeout(n,e||0),t}function ko(e=()=>{},{withinMs:t=500,timeoutInMs:n=Fo(5)}){let[r,s,a]=pt(),[u,f]=Mr(s,t),[l,p]=Mr(a,n),d=e(u);return u(),l(),r.finally(()=>{d&&d(),f(),p()})}function $o(e,...t){let n=()=>a.forEach(u=>u()),r=qo(e,n),[s,a]=t.map(u=>Uo(r,u)).reduce(..._r());return n(),Promise.allSettled(s)}function Uo(e,t){let{allowedToStartNext:n,bumpRunCount:r,unbump:s}=e,[a,u,f]=pt();return[a,Lo(()=>{r(),t().then(u,f).finally(s)}).when(n)]}function qo(e,t){let n=0;return{allowedToStartNext:()=>n<Math.max(1,e),bumpRunCount:()=>t(++n),unbump:()=>t(--n)}}function jo(e,...t){let[n,r,s]=pt();return t.reduce(Bo(s),Promise.resolve(e)).then(r).catch(s),n}function Bo(e){return(t,n)=>t.then(n,e)}});var At=Ce(ze());var zi=Ce(lt()),Bn=Ce(ln());var P={FIRST_RUN:"first-run",STORE_HYDRATED:"ui/store-hydrated",STORE_UPDATED:"ui/store-updated",ui:{RENDERING:"ui/rendering",RENDERED:"ui/rendered",TOGGLE_OPEN:"ui/toggle-open",FIND_ACCOUNTS:"ui/find-accounts",FIND_STATEMENTS:"ui/find-statements",VIEW_STATEMENTS:"ui/view-statements",DOWNLOAD_STATEMENTS:"ui/download-statements",DOWNLOADED_STATEMENTS:"ui/downloaded-statements",UPDATE_PROGRESS_BAR:"ui/update-progress-bar",STATEMENTS_WINDOW_READY:"ui/statements-window-ready",STATEMENTS_WINDOW_CLOSED:"ui/statements-window-closed",CLOSE_STATEMENTS_WINDOW:"ui/close-statements-window",CHANGE_STATEMENT:"ui/change-statement"},get:{ACCOUNTS:"get/accounts",STATEMENTS:"get/statements",ENTRIES:"get/entries"},error:{ACCOUNTS:"error/accounts",STATEMENTS:"error/statements",ENTRIES:"error/entries"},got:{ACCOUNTS:"got/accounts",STATEMENTS:"got/statements",ENTRIES:"got/entries"},add:{ACCOUNTS:"add/accounts",STATEMENTS:"add/statements",ENTRIES:"add/entries"},update:{ACCOUNTS:"update/accounts",STATEMENTS:"update/statements",ENTRIES:"update/entries"}};function Ie(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!1)var s,a;throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(u){return"'"+u+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ze(e){return!!e&&!!e[we]}function He(e){return!!e&&(function(t){if(!t||typeof t!="object")return!1;var n=Object.getPrototypeOf(t);return!n||n===Object.prototype}(e)||Array.isArray(e)||!!e[kr]||!!e.constructor[kr]||pn(e)||dn(e))}function dt(e,t,n){n===void 0&&(n=!1),et(e)===0?(n?Object.keys:mn)(e).forEach(function(r){n&&typeof r=="symbol"||t(r,e[r],e)}):e.forEach(function(r,s){return t(s,r,e)})}function et(e){var t=e[we];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:pn(e)?2:dn(e)?3:0}function hn(e,t){return et(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function zo(e,t){return et(e)===2?e.get(t):e[t]}function $r(e,t,n){var r=et(e);r===2?e.set(t,n):r===3?(e.delete(t),e.add(n)):e[t]=n}function Ho(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function pn(e){return Go&&e instanceof Map}function dn(e){return Vo&&e instanceof Set}function Ge(e){return e.o||e.t}function gn(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Yo(e);delete t[we];for(var n=mn(t),r=0;r<n.length;r++){var s=n[r],a=t[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(Object.getPrototypeOf(e),t)}function yn(e,t){return t===void 0&&(t=!1),En(e)||Ze(e)||!He(e)||(et(e)>1&&(e.set=e.add=e.clear=e.delete=Wo),Object.freeze(e),t&&dt(e,function(n,r){return yn(r,!0)},!0)),e}function Wo(){Ie(2)}function En(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function ke(e){var t=Ko[e];return t||Ie(18,e),t}function jr(){return mt}function bn(e,t){t&&(ke("Patches"),e.u=[],e.s=[],e.v=t)}function $t(e){Sn(e),e.p.forEach(Jo),e.p=null}function Sn(e){e===mt&&(mt=e.l)}function Fr(e){return mt={p:[],l:mt,h:e,m:!0,_:0}}function Jo(e){var t=e[we];t.i===0||t.i===1?t.j():t.g=!0}function Tn(e,t){t._=t.p.length;var n=t.p[0],r=e!==void 0&&e!==n;return t.h.O||ke("ES5").S(t,e,r),r?(n[we].P&&($t(t),Ie(4)),He(e)&&(e=jt(t,e),t.l||Ft(t,e)),t.u&&ke("Patches").M(n[we],e,t.u,t.s)):e=jt(t,n,[]),$t(t),t.u&&t.v(t.u,t.s),e!==Lr?e:void 0}function jt(e,t,n){if(En(t))return t;var r=t[we];if(!r)return dt(t,function(a,u){return Ur(e,r,t,a,u,n)},!0),t;if(r.A!==e)return t;if(!r.P)return Ft(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var s=r.i===4||r.i===5?r.o=gn(r.k):r.o;dt(r.i===3?new Set(s):s,function(a,u){return Ur(e,r,s,a,u,n)}),Ft(e,s,!1),n&&e.u&&ke("Patches").R(r,n,e.u,e.s)}return r.o}function Ur(e,t,n,r,s,a){if(Ze(s)){var u=jt(e,s,a&&t&&t.i!==3&&!hn(t.D,r)?a.concat(r):void 0);if($r(n,r,u),!Ze(u))return;e.m=!1}if(He(s)&&!En(s)){if(!e.h.N&&e._<1)return;jt(e,s),t&&t.A.l||Ft(e,s)}}function Ft(e,t,n){n===void 0&&(n=!1),e.h.N&&e.m&&yn(t,n)}function wn(e,t){var n=e[we];return(n?Ge(n):e)[t]}function qr(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function vn(e){e.P||(e.P=!0,e.l&&vn(e.l))}function Nn(e){e.o||(e.o=gn(e.t))}function An(e,t,n){var r=pn(t)?ke("MapSet").T(t,n):dn(t)?ke("MapSet").F(t,n):e.O?function(s,a){var u=Array.isArray(s),f={i:u?1:0,A:a?a.A:jr(),P:!1,I:!1,D:{},l:a,t:s,k:null,o:null,j:null,C:!1},l=f,p=Lt;u&&(l=[f],p=Ut);var d=Proxy.revocable(l,p),m=d.revoke,y=d.proxy;return f.k=y,f.j=m,y}(t,n):ke("ES5").J(t,n);return(n?n.A:jr()).p.push(r),r}function Xo(e){return Ze(e)||Ie(22,e),function t(n){if(!He(n))return n;var r,s=n[we],a=et(n);if(s){if(!s.P&&(s.i<4||!ke("ES5").K(s)))return s.t;s.I=!0,r=Br(n,a),s.I=!1}else r=Br(n,a);return dt(r,function(u,f){s&&zo(s.t,u)===f||$r(r,u,t(f))}),a===3?new Set(r):r}(e)}function Br(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return gn(e)}var zr,mt,Dn=typeof Symbol!="undefined"&&typeof Symbol("x")=="symbol",Go=typeof Map!="undefined",Vo=typeof Set!="undefined",Hr=typeof Proxy!="undefined"&&Proxy.revocable!==void 0&&typeof Reflect!="undefined",Lr=Dn?Symbol.for("immer-nothing"):((zr={})["immer-nothing"]=!0,zr),kr=Dn?Symbol.for("immer-draftable"):"__$immer_draftable",we=Dn?Symbol.for("immer-state"):"__$immer_state",Da=typeof Symbol!="undefined"&&Symbol.iterator||"@@iterator";var mn=typeof Reflect!="undefined"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Yo=Object.getOwnPropertyDescriptors||function(e){var t={};return mn(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Ko={},Lt={get:function(e,t){if(t===we)return e;var n=Ge(e);if(!hn(n,t))return function(s,a,u){var f,l=qr(a,u);return l?"value"in l?l.value:(f=l.get)===null||f===void 0?void 0:f.call(s.k):void 0}(e,n,t);var r=n[t];return e.I||!He(r)?r:r===wn(e.t,t)?(Nn(e),e.o[t]=An(e.A.h,r,e)):r},has:function(e,t){return t in Ge(e)},ownKeys:function(e){return Reflect.ownKeys(Ge(e))},set:function(e,t,n){var r=qr(Ge(e),t);if(r==null?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var s=wn(Ge(e),t),a=s==null?void 0:s[we];if(a&&a.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(Ho(n,s)&&(n!==void 0||hn(e.t,t)))return!0;Nn(e),vn(e)}return e.o[t]=n,e.D[t]=!0,!0},deleteProperty:function(e,t){return wn(e.t,t)!==void 0||t in e.t?(e.D[t]=!1,Nn(e),vn(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Ge(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty:function(){Ie(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Ie(12)}},Ut={};dt(Lt,function(e,t){Ut[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Ut.deleteProperty=function(e,t){return Lt.deleteProperty.call(this,e[0],t)},Ut.set=function(e,t,n){return Lt.set.call(this,e[0],t,n,e[0])};var Qo=function(){function e(n){this.O=Hr,this.N=!0,typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(n,r,s){if(typeof n=="function"&&typeof r!="function"){var a=r;r=n;var u=this;return function(m){var y=this;m===void 0&&(m=a);for(var E=arguments.length,b=Array(E>1?E-1:0),S=1;S<E;S++)b[S-1]=arguments[S];return u.produce(m,function(A){var O;return(O=r).call.apply(O,[y,A].concat(b))})}}var f;if(typeof r!="function"&&Ie(6),s!==void 0&&typeof s!="function"&&Ie(7),He(n)){var l=Fr(this),p=An(this,n,void 0),d=!0;try{f=r(p),d=!1}finally{d?$t(l):Sn(l)}return typeof Promise!="undefined"&&f instanceof Promise?f.then(function(m){return bn(l,s),Tn(m,l)},function(m){throw $t(l),m}):(bn(l,s),Tn(f,l))}if(!n||typeof n!="object")return(f=r(n))===Lr?void 0:(f===void 0&&(f=n),this.N&&yn(f,!0),f);Ie(21,n)},t.produceWithPatches=function(n,r){var s,a,u=this;return typeof n=="function"?function(f){for(var l=arguments.length,p=Array(l>1?l-1:0),d=1;d<l;d++)p[d-1]=arguments[d];return u.produceWithPatches(f,function(m){return n.apply(void 0,[m].concat(p))})}:[this.produce(n,r,function(f,l){s=f,a=l}),s,a]},t.createDraft=function(n){He(n)||Ie(8),Ze(n)&&(n=Xo(n));var r=Fr(this),s=An(this,n,void 0);return s[we].C=!0,Sn(r),s},t.finishDraft=function(n,r){var s=n&&n[we],a=s.A;return bn(a,r),Tn(void 0,a)},t.setAutoFreeze=function(n){this.N=n},t.setUseProxies=function(n){n&&!Hr&&Ie(20),this.O=n},t.applyPatches=function(n,r){var s;for(s=r.length-1;s>=0;s--){var a=r[s];if(a.path.length===0&&a.op==="replace"){n=a.value;break}}var u=ke("Patches").$;return Ze(n)?u(n,r):this.produce(n,function(f){return u(f,r.slice(s+1))})},e}(),ve=new Qo,tt=ve.produce,Oa=ve.produceWithPatches.bind(ve),xa=ve.setAutoFreeze.bind(ve),Ca=ve.setUseProxies.bind(ve),Ia=ve.applyPatches.bind(ve),Ra=ve.createDraft.bind(ve),Pa=ve.finishDraft.bind(ve);(function(){if(typeof window.CustomEvent=="function")return!1;function e(t,n){n=n||{bubbles:!1,cancelable:!1,detail:null};let r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),r}window.CustomEvent=e})();var Le=function(){let e;try{e=window}catch(l){e=self}let t="message-bus",n=new Map;function r(l,...p){let d={eventName:l,args:p,timestamp:Date.now()},m=new CustomEvent(t,{detail:d});e.dispatchEvent(m)}function s(l,p){if(typeof p!="function")throw new TypeError("Callback is not a function");let d=n.has(l)?n.get(l):n.set(l,new Map).get(l);if(d.has(p))throw new Error("Callback already deals with this event");let m=typeof l=="string"&&l.indexOf("*")===-1,y=typeof l=="string"?u(l):l instanceof RegExp?l:null;if(y===null){let b="Could not figure-out eventNameOrPattern";throw new Error(`${b} = ${l}`)}let E=b=>{let{eventName:S,args:A}=b.detail;y.test(S)&&(m?p(...A):p(S,...A))};return d.set(p,E),e.addEventListener(t,E),()=>a(l,p)}function a(l,p){if(typeof p!="function")throw new TypeError("Callback is not a function");if(!n.has(l))throw new Error("No event-listener for that name/pattern");let d=n.get(l);if(!d.has(p))throw new Error("Event callback not found for name/pattern");let m=d.get(p);e.removeEventListener(t,m),d.delete(p)}function u(l){if(!l.length)throw new Error("String should not be empty");let p=l.split("*").map(m=>m.trim()).map(f),d=p.join(".*");return p.length===1?d=`^${d}$`:(p[0]!==""&&(d=`^${d}`),p[p.length-1]!==""&&(d=`${d}$`)),new RegExp(d)}function f(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return{emit:r,on:s,off:a}}();function Zo(e){return On(e)&&Ve(e.emit)&&(Ve(e.addListener)||Ve(e.on))&&(Ve(e.removeListener)||Ve(e.off))}Zo.displayName="isEventEmitter";function ce(e){return e==null}xn.displayName="isUnset";function xn(e){return Array.isArray(e)}xn.displayName="isArray";function Ve(e){return typeof e=="function"}Ve.displayName="isFunction";function j(e){return typeof e=="string"}j.displayName="isString";function ge(e){return typeof e=="number"}ge.displayName="isNumber";function On(e){return typeof e=="object"}On.displayName="isObject";function es(e){return e===null||!On(e)?!1:Object.getPrototypeOf(e)===Object.prototype}es.displayName="isPojo";function ts(e){return j(e)?!0:xn(e)?e.every(j):!1}ts.displayName="isTemplateLiteral";var ns=(e,t,n)=>t(n)?void 0:`${t.displayName||t.name}(${e}) did not return true`,rs=(e,t,n)=>typeof n===t?void 0:`Argument "${e}" should be a ${t}`,is=(e,t,n)=>{let{argName:r,argType:s}=e[n];if(t===void 0)return`Argument undefined: "${r}"`;let a=Array.isArray(s)?s:[s],u=a.map(p=>Ve(p)?ns(r,p,t):rs(r,p,t)).filter(j);if(a.length>1?u.length>1:u.length)return`${u.join(`
| `)}
> typeof ${r} === ${typeof t}(${JSON.stringify(t)})`};function os(e){return(t,n,...r)=>{let s=Object.entries(n).map(([f,l])=>({argName:f,argType:l})),a=r.map((...f)=>is(s,...f)).filter(j);if(!a.length)return;let u=Object.keys(n).join(", ");return`
${e||""}${t}(${u}):
${a.map(f=>`| ${f}`).join(`
`)}`}}function Gr(e){let t=os(e);return(n,r,s)=>{let a=Object.keys(r),u=ss(s,{keys:a});return t(n,r,...u)}}function ss(e,t){let{keys:n}=t;return Array.isArray(n)?n.reduce((r,s)=>[...r,e[s]],[]):Object.values(e)}var as=10,nt=[{accounts:[],statements:[],entries:[]}];function cs(e){rt(e),Le.emit(P.STORE_HYDRATED)}function Z(){return nt[nt.length-1]}Z.history=nt;Z.hydrate=cs;function rt(e){nt.push(e),nt.length>as&&nt.shift(),Le.emit(P.STORE_UPDATED)}var ht=Gr("store#");Le.on(P.add.ACCOUNTS,e=>{let t=Z(),n=tt(t,r=>{e.forEach(s=>{let a=ht(P.add.ACCOUNTS,{id:j,accountNumber:j,sortCode:j,name:[j,ce],type:[j,ce],iban:[j,ce],bic:[j,ce]},s);if(a)throw TypeError(a);let u=r.accounts.find(f=>f.id===s.id);if(u){console.log("Account exists",u);return}r.accounts.push({...s})})});n!==t&&rt(n)});Le.on(P.update.ACCOUNTS,e=>{let t=[],n=Z(),r=tt(n,s=>{e.forEach(a=>{let u=ht(P.update.ACCOUNTS,{id:j,accountNumber:[j,ce],sortCode:[j,ce],name:[j,ce],type:[j,ce],iban:[j,ce],bic:[j,ce]},a);if(u)throw TypeError(u);let f=s.accounts.find(l=>l.id===a.id);if(!f){t.push(a);return}Object.entries(a).forEach(([l,p])=>{ce(p)||(f[l]=p)})})});t.length&&console.log("Not updating unseen accounts: ",t),r!==n&&rt(r)});Le.on(P.add.STATEMENTS,e=>{let t=[],n=Z(),r=tt(n,s=>{e.forEach(a=>{let u=ht(P.add.STATEMENTS,{id:j,accountId:j,endDate:ge,startDate:[ge,ce],startBalance:[ge,ce],endBalance:[ge,ce]},a);if(u)throw TypeError(u);let f=s.statements.find(l=>l.id===a.id);if(f){t.push(f);return}s.statements.push({...a})})});t.length&&console.log("Not overwriting existing statements: ",t),r!==n&&rt(r)});Le.on(P.update.STATEMENTS,e=>{let t=[],n=Z(),r=tt(n,s=>{e.forEach(a=>{let u=ht(P.update.STATEMENTS,{id:j,accountId:[j,ce],endDate:ge,startDate:ge,startBalance:ge,endBalance:ge},a);if(u)throw TypeError(u);let f=s.statements.find(l=>l.id===a.id);if(!f){t.push(a);return}Object.entries(a).forEach(([l,p])=>{ce(p)||(f[l]=p)})})});t.length&&console.log("Not updating unseen statements: ",t),r!==n&&rt(r)});Le.on(P.add.ENTRIES,e=>{let t=[],n=Z(),r=tt(n,s=>{e.forEach(a=>{let u=ht(P.add.ENTRIES,{id:j,accountId:j,statementId:j,date:ge,type:j,payee:j,note:j,debit:ge,credit:ge,balance:ge},a);if(u)throw TypeError(u);let f=s.entries.find(l=>l.id===a.id);if(f){t.push(f);return}s.entries.push({...a})})});t.length&&console.log("Not overwriting existing entries: ",t),r!==n&&rt(r)});var Pn=Ce(ln());function ue(e){return String(e).replace(/</g,"&lt;").replace(/>/g,"&gt;").trim()}function te(e){return String(e).replace(/"/g,'""').replace(/\r\n|\r|\n/g," ").trim()}function Me(e){return String(e).replace(/\r\n|\r|\n/g," ").trim()}function Cn(e){let t=new Date(e);return String(De(t.getMonth()+1)+"/"+De(t.getDate())+"/"+t.getFullYear())}function gt(e){let t=new Date(e);return String(De(t.getDate())+"/"+De(t.getMonth()+1)+"/"+t.getFullYear())}function yt(e){let t=new Date(e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return String(t.getDate()+" "+n[t.getMonth()]+" "+t.getFullYear())}function Oe(e,t=""){let n=new Date(e);return[n.getFullYear(),De(n.getMonth()+1),De(n.getDate()),De(n.getHours()),De(n.getMinutes()),De(n.getSeconds())].join(t)}function De(e){return e<10?"0"+e:""+e}function L(e){return!e||typeof e!="number"?"-":(e/100).toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}function Vr(){return{id:"CSV",folder:"csv",extension:"csv",description:"CSV RFC4180 (Excel, Numbers)",generate:e=>{let t=['"Transaction ID","Date","Account type","Account number","Payee","Memo","Type","Amount"',""];return e.entries.forEach(n=>{let{debit:r,credit:s,id:a,date:u,payee:f,note:l,type:p}=n,d=L(r+s);t.push('"'+te(a)+'","'+te(yt(u))+'","'+te(e.type)+'","'+te(e.sortCode+" "+e.accountNumber)+'","'+te(f)+'","'+te(l||"")+'","'+te(p)+'","'+te(d)+'"')}),t.push(""),t.join(`\r
`)}}}function In(e,t){if(!e)return"";for(e=""+e;e.length<t;)e=e+" ";return e.length>t&&(e.length=t),e}function Yr(){return{id:"HSBC",folder:"hsbc-legacy",extension:"csv",description:"CSV Legacy HSBC (\xE0 la Recent Transactions)",generate:e=>{let t=[];return e.entries.forEach(n=>{let{debit:r,credit:s,id:a,date:u,payee:f,note:l,type:p}=n,d=L(r+s);t.push('"'+te(gt(u))+'","'+te(In(f,25)+In(l||"",25)+p)+'","'+te(d)+'"')}),t.push(""),t.join(`\r
`)}}}function Wr(){return{id:"JSON",folder:"json",extension:"json",description:"JSON (JavaScript Object Notation)",generate:e=>JSON.stringify(e,(t,n)=>{if(["debit","credit","balance"].indexOf(t)!==-1){let r=parseFloat(L(n));return isNaN(r)?t==="balance"?void 0:0:r}return n},2)}}function Ye(e){return e?function(n,r){return+n[e]-+r[e]}:function(n,r){return+n-+r}}function Kr(){return{id:"MIDATA",folder:"midata",extension:"csv",description:"midata (non-standard, CSV)",generate:e=>{let n=(e.balances||[{date:0,balance:0}]).sort(Ye("date"))[0].balance,r=[" Date,Type,Merchant/Description,Debit/Credit,Balance",""];return e.entries.forEach(s=>{let{debit:a,credit:u,date:f,type:l,payee:p,note:d}=s,m=a+u;n+=m,r.push('"'+te(gt(f))+'","'+te(l)+'","'+te(p+(d||""))+'","'+te(L(m))+'","'+te(L(n))+'"')}),r.push("","Arranged overdraft limit,"+te(gt(e.date))+",\xA30.00",""),r.join(`\r
`)}}}var Rn={INTU_BID:"01267",LANGUAGE:"ENG",CURDEF:"GBP"};function Jr(){return{id:"OFX",folder:"ofx",extension:"ofx",description:"OFX 1.0.2 (Money, Quicken)",generate:e=>{let t,n=e.balances.length-1;function r(a){switch(a){case"ATM":break;case"TFR":a="XFER";break;default:a="OTHER"}return a}t=`OFXHEADER:100
DATA:OFXSGML
VERSION:102
SECURITY:NONE
ENCODING:USASCII
CHARSET:1252
COMPRESSION:NONE
OLDFILEUID:NONE
NEWFILEUID:NONE

<OFX>

	<SIGNONMSGSRSV1>
		<SONRS>
			<STATUS>
				<CODE>0</CODE>
				<SEVERITY>INFO</SEVERITY>
			</STATUS>
			<DTSERVER>`+ue(Oe(new Date))+`</DTSERVER>
			<LANGUAGE>`+ue(Rn.LANGUAGE)+`</LANGUAGE>
			<INTU.BID>`+ue(Rn.INTU_BID)+`</INTU.BID>
		</SONRS>
	</SIGNONMSGSRSV1>

	<BANKMSGSRSV1>

		<STMTTRNRS>

			<TRNUID>1</TRNUID>

			<STATUS>
				<CODE>0</CODE>
				<SEVERITY>INFO</SEVERITY>
			</STATUS>

			<STMTRS>

				<CURDEF>`+ue(Rn.CURDEF)+`</CURDEF>

				<BANKACCTFROM>
					<BANKID>`+ue(e.sortCode)+`</BANKID>
					<ACCTID>`+ue(e.sortCode+e.accountNumber)+`</ACCTID>
					<ACCTTYPE>CHECKING</ACCTTYPE>
				</BANKACCTFROM>

				<BANKTRANLIST>

					<DTSTART>`+ue(Oe(e.balances[0].date))+`</DTSTART>
					<DTEND>`+ue(Oe(e.balances[n].date))+`</DTEND>

`,e.entries.forEach(a=>{let{debit:u,credit:f,type:l,date:p,id:d,payee:m,note:y}=a,E=L(u+f);t+=`					<STMTTRN>
						<TRNTYPE>`+ue(r(l))+`</TRNTYPE>
						<DTPOSTED>`+ue(Oe(p))+`</DTPOSTED>
						<TRNAMT>`+ue(E)+`</TRNAMT>
						<FITID>`+ue(d)+`</FITID>
						<NAME>`+ue(m)+`</NAME>
`+(y?"						<MEMO>"+ue(y)+`</MEMO>
`:"")+`					</STMTTRN>

`});let s=e.balances[n].balance;return t+=`				</BANKTRANLIST>

				<LEDGERBAL>
					<BALAMT>`+ue(L(s))+`</BALAMT>
					<DTASOF>`+ue(Oe(e.balances[n].date))+`</DTASOF>
				</LEDGERBAL>

			</STMTRS>
		</STMTTRNRS>
	</BANKMSGSRSV1>

</OFX>
`,t}}}function Xr(){return{id:"QIF",folder:"qif",extension:"qif",description:"QIF (Quicken)",generate:e=>{let t,n=e.balances.length-1;return t=`!Account
N`+Me(e.type)+`
A`+Me(e.sortCode+"/"+e.sortCode+e.accountNumber)+`
/`+Me(Cn(e.balances[n].date))+`
$`+Me(L(e.balances[n].balance))+`
TBank
^
!Type:Bank
`,e.entries.forEach(r=>{let{debit:s,credit:a,id:u,date:f,payee:l,note:p,type:d}=r,m=L(s+a);t+="D"+Me(Cn(f))+`
N`+Me(s+a<0?"WITHD":"DEP")+`
T`+Me(m)+`
C
P`+Me(l)+`
`+(p?"M"+Me(p)+`
`:"")+`^
`}),t+=`
`,t}}}var{SparkMD5:us}=obis.deps;function Qr(e){return us.hash(e)}function Zr(){return[Vr(),Yr(),Wr(),Kr(),Jr(),Xr()]}function ei(e){let{date:t,debit:n,credit:r,index:s,accountNumber:a,sortCode:u,type:f,payee:l,note:p}=e,d=Oe(t)||"UNKNOWN_DATE",m=L(n+r);return d+"_"+Qr(d+(s!==void 0?s:"")+(a||"")+(u||"")+(f||"")+(l||"")+(p||"")+m)}function ni(){let{accounts:e,statements:t,entries:n}=Z();return t.reduce((s,a)=>{let u=e.find(S=>S.id===a.accountId),f=[ti(a,"start"),ti(a,"end")],l=n.filter(S=>S.statementId===a.id).map(S=>{let{id:A,date:O,type:$,payee:J,note:ne,debit:B,credit:_,balance:U}=S;return{id:A,date:O,type:$,payee:J,note:ne,debit:B,credit:_,balance:U}}),{iban:p,bic:d,type:m,name:y,accountNumber:E,sortCode:b}=u;return[...s,{id:`${p}_${Oe(a.endDate)}`,iban:p,bic:d,type:m,name:y,accountNumber:E,sortCode:b,date:a.endDate,entries:l,balances:f}]},[])}function ti(e,t){let n=t==="start"?"start":"end",r=n==="start"?"Opening":"Closing",s={debit:0,credit:0,balance:e[`${n}Balance`],date:e[`${n}Date`],payee:"",memo:`${r} balance this month`};return{id:ei(s),...s}}var{fflate:ri,saveAs:fs}=obis.deps;function ii(){let{filename:e,content:t}=ps(),[n,r,s]=Pn.makePromise();return ri.zip(t,(a,u)=>{if(a){s(a);return}r(u)}),n.then(ls).then(a=>{fs(a,e)})}function ls(e){let[t,n]=Pn.makePromise();return n(new Blob([e])),t}function ps(){let{filename:e,content:t}=ds();return{filename:e,content:t.reduce((n,{folder:r,files:s})=>({...n,[r]:s.reduce((a,{name:u,content:f})=>a[u]?a:{...a,[u]:ri.strToU8(f)},{})}),{})}}function ds(){let e=ni(),t=Zr(),n=[],r;return t.forEach(s=>{let{generate:a,extension:u,folder:f}=s,l={folder:f,files:[]};e.forEach(p=>{let d=ms(p,u),m=a(p);l.files.push({name:d,content:m}),r||(r=hs(p))}),n.push(l)}),{filename:r,content:n}}function ms(e,t){let{date:n,type:r,sortCode:s,accountNumber:a}=e,u=new Date(n);return`${r} ${s} ${a}`.replace(/[^a-zA-Z0-9-]/g,"_")+"-"+u.getFullYear()+"-"+De(u.getMonth()+1)+"-"+De(u.getDate())+"."+t}function hs(e){let{date:t}=e,n=new Date(t);return"OBIS-Statements-"+n.getFullYear()+"-"+Oe(new Date,"_")+".zip"}var ie=Ce(ze());var oi=Ce(ze()),ye,si=Function.prototype.call.bind(Function.prototype.call),ai=()=>oi.default.redraw(),ci=e=>{let t=ye,n=t.depsIndex++,r=t.depsStates[n]||[],s=e===void 0?!0:Array.isArray(e)?e.length>0?!e.every((a,u)=>a===r[u]):!t.setup:!1;return e!==void 0&&(t.depsStates[n]=e),s},ui=(e=!1)=>(t,n)=>{let r=ye;if(ci(n)){let a=r.depsIndex,u=()=>{let l=t();typeof l=="function"&&(r.teardowns.set(a,l),r.teardowns.set("_",ai))},f=r.teardowns.get(a);try{typeof f=="function"&&f()}finally{r.teardowns.delete(a)}r.updates.push(e?()=>new Promise(l=>requestAnimationFrame(l)).then(u):u)}},Mn=(e,t)=>{let n=ye,r=n.statesIndex++;return n.setup||(n.states[r]=e),[n.states[r],s=>{let a=n.states[r],u=t?t(s,r):s;n.states[r]=u,JSON.stringify(u)!==JSON.stringify(a)&&ai()},r]},q=e=>{let t=ye;return Mn(e,(r,s)=>typeof r=="function"?r(t.states[s],s):r)},fe=ui(!0),kc=ui();var it=(e,t)=>{let n=ye,r=ci(t),[s,a]=n.setup?Mn():Mn(e());return n.setup&&r&&a(e()),s},re=(e,t)=>it(()=>e,t),G=(e,t)=>{let n=u=>{Object.assign(u.state,{setup:!1,states:[],statesIndex:0,depsStates:[],depsIndex:0,updates:[],cleanups:new Map,teardowns:new Map})},r=u=>{let f=ye;ye=u.state;try{u.state.updates.forEach(si)}finally{Object.assign(u.state,{setup:!0,updates:[],depsIndex:0,statesIndex:0}),ye=f}};return{oninit:n,oncreate:r,onupdate:r,view:u=>{let f=ye;ye=u.state;try{return e({...t,...u.attrs,vnode:u,children:u.children})}catch(l){console.error(l)}finally{ye=f}},onremove:u=>{let f=ye;ye=u.state;try{[...u.state.teardowns.values()].forEach(si)}finally{ye=f}}}};function fi(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r&&r.push(n)||e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&r.splice(r.indexOf(n)>>>0,1)},emit:function(t,n){(e.get(t)||[]).slice().map(function(r){r(n)}),(e.get("*")||[]).slice().map(function(r){r(t,n)})}}}function gs(e){return li(e)&&Ee(e.emit)&&(Ee(e.addListener)||Ee(e.on))&&(Ee(e.removeListener)||Ee(e.off))}function pi(e){return Array.isArray(e)}function Ee(e){return typeof e=="function"}function le(e){return typeof e=="string"}function li(e){return typeof e=="object"}function Ue(e){return e===null||!li(e)?!1:Object.getPrototypeOf(e)===Object.prototype}function ys(e){return le(e)?!0:pi(e)?e.every(le):!1}var Es=(e,t,n)=>t(n)?void 0:`${t.name}(${e}) did not return true`,bs=(e,t,n)=>typeof n===t?void 0:`Argument "${e}" should be a ${t}`,Ss=(e,t,n)=>{let{argName:r,argType:s}=e[n];if(t===void 0)return`Argument undefined: "${r}"`;let a=Array.isArray(s)?s:[s],u=a.map(p=>Ee(p)?Es(r,p,t):bs(r,p,t)).filter(le);if(a.length>1?u.length>1:u.length)return`${u.join(`
| `)}
> typeof ${r} === ${typeof t}(${JSON.stringify(t)})`};function _n(e){return function(t,n,...r){let s=Object.entries(n).map(([f,l])=>({argName:f,argType:l})),a=r.map((...f)=>Ss(s,...f)).filter(le);if(!a.length)return;let u=Object.keys(n).join(", ");return`
${e||""}${t}(${u}):
${a.map(f=>`| ${f}`).join(`
`)}`}}function kn(e){let t=(f,...l)=>e.emit(f,l),n=e.addListener?(...f)=>e.addListener(...f):(...f)=>e.on(...f),r=e.removeListener?(...f)=>e.removeListener(...f):(...f)=>e.off(...f),s=new Map;function a(f,l){let p=s.get(l);p||(p={handleEvent:d=>l(...d||[]),refCount:0},s.set(l,p)),p.refCount+=1,n(f,p.handleEvent)}function u(f,l){let p=s.get(l);!p||(r(f,p.handleEvent),p.refCount-=1,p.refCount===0&&s.delete(l))}return{emit:t,on:a,off:u}}function di(e){return e.reduce((t,n)=>t.indexOf(n)===-1?[...t,n]:t,[])}function Ts(e,t){t=t||function(){};let n=!!e;function r(s){return(...a)=>n?(t(),!1):s(...a)}return{Pausable:r,paused:()=>n,pause:()=>{n=!0},resume:()=>{n=!1}}}function $n(e,t,n,...r){let s=[...r].flat().reduce((m,y)=>({...m,[y]:0}),{});function a(m){return s[m]=f(m)+1,()=>{u(m)}}function u(m){let y=f(m)-1;s[m]=Math.max(y,0)}function f(m){return s[m]||0}function l(){return{...s}}function p(){return Object.keys(s).sort().map(m=>[m,s[m]]).map(([m,y])=>({[t]:m,refs:y||"None"}))}function d(){return{description:`Statebot[${e}]: ${n}:`,table:p()}}return{increase:a,decrease:u,countOf:f,toValue:d,refs:l}}function ws(e,t){le(e)&&(e={info:3,log:2,warn:1,none:0}[e]||3);function n(){return e>=1}function r(){return e>=2}function s(){return e>=3}let{info:a,table:u,log:f,warn:l,error:p}=t||console;return{canWarn:n,canLog:r,canInfo:s,info:(...d)=>{s()&&a(...d)},table:(...d)=>{r()&&u(...d)},log:(...d)=>{r()&&f(...d)},warn:(...d)=>{n()&&l(...d)},error:(...d)=>{p(...d)}}}var vs=/[\r\n]/,mi="|",Et="->",Ns=[mi,Et].map(e=>e.replace("|","\\|")).join("|"),As=new RegExp(`(${Ns})$`),Ds=/[^a-z0-9!@#$%^&*:_+=<>|~.\x2D]/gi,Os=/(\/\/[^\n\r]*)/,xs=_n("statebot.");function hi(e){let t=xs("decomposeChart",{chart:ys},e);if(t)throw TypeError(t);let n=Cs(e),r=Is(n),a=r.map(Rs).flat(1).map(Ps).flat(1),u=!1,f=a.map(d=>(d.includes("")&&(u=!0),d.join(Et))),l=di(f),p=di(r.flat(3));return{transitions:l.map(d=>d.split(Et)),routes:l,states:u?p:p.filter(Boolean)}}function Ms(e){return[e].flat().reduce((t,n)=>[...t,...n.split(vs)],[])}function Cs(e){let t=Ms(e),n=[],r=!1,s=(u,f)=>{let l=f.replace(Os,"").replace(Ds,"");return l?(r=As.test(l),r?u+l:(n.push(u+l),"")):u},a=t.reduce(s,"");return r||a?[...n,a]:[...n]}function Is(e){return e.map(t=>t.split(Et).map(n=>n.split(mi)))}function Rs(e){let t=[];return e.reduce((n,r)=>n===!1?[...r]:(t.push([n,[...r]]),[...r]),!1),t}function Ps([e,t]){return e.reduce((n,r)=>[...n,...t.map(s=>[r,s])],[])}var gi="onExiting",yi="onEntering",Ei="onExited",bi="onEntered",bt="onSwitching",St="onSwitched",Tt={[bt]:"(ANY)state:changing",[St]:"(ANY)state:changed"};function Ti(e,t){if(!le(e))throw new TypeError(`
Statebot: Please specify a name for this machine`);let n=`Statebot[${e}]`;if(!Ue(t))throw new TypeError(`
${n}: Please specify options for this machine`);let{chart:r=void 0,logLevel:s=3,historyLimit:a=2}=t||{},u=t.events===void 0?kn(fi()):gs(t.events)&&kn(t.events);if(!u)throw new TypeError(`
${n}: Invalid event-emitter specified in options`);let{states:f=[],routes:l=[]}=r?hi(r):t,{startIn:p=f[0]}=t;if(!f.includes(p))throw new Error(`${n}: Starting-state not in chart: "${p}"`);let d=_n(`${n}#`),m=ws(s,console),{canWarn:y}=m,E=[p],b=Math.max(a,2),S=0,{pause:A,resume:O,paused:$,Pausable:J}=Ts(!1,()=>m.warn(`${n}: Ignoring callback, paused`)),ne=kn(fi()),B=J(ne.emit);function _(v,N){return ne.on(v,N),()=>ne.off(v,N)}let U=$n(e,"states","Listening for the following state-changes",[...f]),se=$n(e,"transitions","Listening for the following transitions",[...l]),W=$n(e,"events","Listening for the following events");function Ae(v,N){let x=Ee(v)?v({enter:Pe,emit:je,Enter:xt,Emit:Ot}):Ue(v)?v:null;if(!Ue(x))throw new TypeError(`Statebot[${e}]#${N}(): Expected an object, or a function that returns an object`);let M=[],z=[],{transitionsForEvents:o,transitionsOnly:i}=_s(x),c=Object.entries(o).reduce(C,{}),h=Si(i,y),g=Object.entries(c).map(D).concat(h.configs.map(T)).flat();if(y()){M.push(...h.states),z.push(...h.routes);let I=M.filter(k=>!f.includes(k)),he=z.filter(k=>!l.includes(k));I.length&&m.warn(`Statebot[${e}]#${N}(): Invalid states specified:
`+I.map(k=>`  > "${k}"`).join(`
`)),he.length&&m.warn(`Statebot[${e}]#${N}(): Invalid transitions specified:
`+he.map(k=>`  > "${k}"`).join(`
`))}return()=>g.map(I=>I());function T(I){let{fromState:he,toState:k,action:H}=I,xe=`${he}->${k}`;return[se.increase(xe),_(xe,H)]}function C(I,[he,k]){let{states:H,routes:xe,configs:ae}=Si(k,y);return y()&&(M.push(...H),z.push(...xe)),{...I,[he]:ae}}function R({fromState:I,toState:he,action:k,args:H}){return X(I,()=>(Pe(he,...H),Ee(k)&&k(...H),!0))}function D([I,he]){return[W.increase(I),Te(I,(...k)=>{he.map(xe=>({...xe,args:k})).some(R)||We(`Event not handled: "${I}"`)})]}}function pe(){return E[E.length-2]}function ee(){return E[E.length-1]}function $e(...v){let N=v.flat(),x=d("canTransitionTo",{state:le},N[0]);if(x)throw new TypeError(x);if(!N.length)return!1;let M=be();return N.every(z=>M.includes(z))}function be(v){let N=v!==void 0?v:ee(),x=d("statesAvailableFromHere",{state:le},N);if(x)throw new TypeError(x);return l.reduce((M,z)=>{let[o,i]=z.split(Et).map(c=>c.trim());return o===N?[...M,i]:M},[])}function Se(v,N,...x){let M=ee()===v;return N===void 0?M:M?Ee(N)?N(...x):N:null}function F(v,...N){let x=Object.entries(v).find(([M])=>Se(M));return x?Se(...x.concat(N)):null}function X(...v){let N=d("inState",{state:[le,Ue]},v[0]);if(N)throw new TypeError(N);return Ue(v[0])?F(...v):Se(...v)}let je=J((v,...N)=>{let x=d("emit",{eventName:le},v);if(x)throw new TypeError(x);return u.emit(v,...N)}),Pe=J((v,...N)=>{let x=d("enter",{state:le},v);if(x)throw new TypeError(x);let M=ee(),z=v;if(z===M)return We(`Already in state: "${z}"`),!1;if(!f.includes(z))return We(`Invalid state "${z}", not switching`),!1;let o=`${M}->${z}`;return l.includes(o)?(m.info(`${n}: tId<${++S}>: ${o}`),E.push(z),E.length>b&&E.shift(),B(Tt[bt],z,M,...N),B(o,...N),B(Tt[St],z,M,...N),!0):(We(`Invalid transition "${o}", not switching`),!1)});function Te(v,N){let x=d("onEvent",{eventName:le,cb:Ee},v,N);if(x)throw new TypeError(x);return u.on(v,N),()=>u.off(v,N)}let st=Object.keys(Tt).reduce((v,N)=>({...v,[N]:x=>{let M=d(N,{cb:Ee},x);if(M)throw new TypeError(M);let z=U.increase(Tt[N]),o=_(Tt[N],x);return()=>{o(),z()}}}),{}),Fe=[[gi,bt],[yi,bt],[Ei,St],[bi,St]].reduce((v,N)=>{let[x,M]=N,z=x.slice(2),o=z.toLowerCase();return{...v,[x]:(i,c)=>{let h=d(x,{state:le,cb:Ee},i,c);if(h)throw new TypeError(h);let g=[U.increase(i),U.increase(`${i}:${o}`)],T=st[M]((C,R,...D)=>{z.indexOf("Exit")===0?i===R&&c(C,...D):i===C&&c(R,...D)});return()=>{T(),g.map(C=>C())}}}},{});function Ot(v,...N){let x=d("Emit",{eventName:le},v);if(x)throw new TypeError(x);return(...M)=>je(v,...N,...M)}function xt(v,...N){let x=d("Enter",{state:le},v);if(x)throw new TypeError(x);return(...M)=>Pe(v,...N,...M)}function Ht(v,N,...x){return(...M)=>X(v,N,...x,...M)}function Gt(v,...N){return(...x)=>X(v,...N,...x)}function at(...v){let N=d("InState",{state:[le,Ue]},v[0]);if(N)throw new TypeError(N);return Ue(v[0])?Gt(...v):Ht(...v)}function Ct(){m.warn(`${n}: State-machine reset!`),E.length=0,E.push(p)}function We(v){let N=pe(),x=ee(),M=`${N===void 0?"[undefined]":N}->${x}`,z=be();z.length?m.info(`${n}: ${v}
  > Previous transition: "${M}"
  > From "${x}", valid states are: [${z.map(o=>`"${o}"`).join(", ")}]`):m.info(`${n}: ${v}
  > Previous transition: "${M}"
  > There are no states available from "${x}"`)}function Vt(){return{states:U.refs(),transitions:se.refs(),events:W.refs()}}function ct(){m.log(`${n}: Information about this state-machine`),Ke(U),Ke(se),Ke(W)}function Ke(v){let{description:N,table:x}=v.toValue();m.log(N),x.length?m.table(x):m.log("  > No information")}return{__STATEBOT__:1,canTransitionTo:$e,currentState:ee,emit:je,Emit:Ot,enter:Pe,Enter:xt,history:()=>[...E],info:()=>ct(),inspect:()=>Vt(),inState:X,InState:at,name:()=>e,onEntered:Fe[bi],onEntering:Fe[yi],onEvent:Te,onExited:Fe[Ei],onExiting:Fe[gi],onSwitched:st[St],onSwitching:st[bt],onTransitions:v=>Ae(v,"onTransitions"),pause:A,paused:$,performTransitions:v=>Ae(v,"performTransitions"),previousState:pe,reset:Ct,resume:O,statesAvailableFromHere:be}}function _s(e){let t={},n=[];return Object.entries(e).map(([r,s])=>{if(Ee(s)){n.push({routeChart:r,action:s});return}if(!Ue(s))return;let{on:a,then:u}=s;if(le(a)||pi(a)){[a].flat().map(p=>{t[p]=t[p]||[],t[p].push({routeChart:r,action:u})});return}Ee(u)&&n.push({routeChart:r,action:s})}),{transitionsForEvents:t,transitionsOnly:n}}function Si(e,t){let n=[],r=[];return{configs:e.reduce((a,u)=>{let{routeChart:f,action:l}=u,{states:p,routes:d,transitions:m}=hi(f);return t()&&(n.push(...p),r.push(...d)),[...a,...m.map(([y,E])=>({fromState:y,toState:E,action:l}))]},[]),states:n,routes:r}}var jc=_n("statebot.");function jn(e){let[t,n]=q(e.currentState());return fe(()=>{let r=!1,s=e.onSwitched(a=>{r||n(a)});return()=>{r=!0,s()}},[e]),t}function wi(e,t){let{bot:n,listeners:r}=it(()=>{let{performTransitions:a={},onTransitions:u={},...f}=t||{},l=Ti(e,f),p=[l.performTransitions(a),l.onTransitions(u)];return{bot:l,listeners:p}},[]);return fe(()=>()=>{typeof n.pause=="function"&&n.pause(),r.forEach(a=>a())},[n,r]),{state:jn(n),bot:n}}function vi(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=vi(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Re(){for(var e=0,t,n,r="";e<arguments.length;)(t=arguments[e++])&&(n=vi(t))&&(r&&(r+=" "),r+=n);return r}var qt=Ce(ze());var Fn=Ce(lt()),ks=G(e=>{let{children:t}=e||{},{setRef:n=()=>{}}=e||{};return qt.default("div",{oncreate:r=>n(r.dom)},t)}),qe={TOGGLE_OPEN:"toggle-open",OPEN_FINISHED:"open-finished",CLOSE_FINISHED:"close-finished"},$s=`
  closed -> opening -> opened
  opened -> closing -> closed
`,Ni=G(e=>{let{children:t}=e||{},{opened:n=!1,durationInMs:r=250}=e||{},{state:s,bot:a}=wi("animated-close/open",{chart:$s,startIn:n?"opened":"closed",logLevel:2,performTransitions:({Emit:y})=>({"closed -> opening":{on:qe.TOGGLE_OPEN,then:Fn.Delay(y(qe.OPEN_FINISHED),r)},"opening -> opened":{on:qe.OPEN_FINISHED},"opened -> closing":{on:qe.TOGGLE_OPEN,then:Fn.Delay(y(qe.CLOSE_FINISHED),r)},"closing -> closed":{on:qe.CLOSE_FINISHED}})}),[u,f]=q(!0);fe(()=>{if(u){f(!1);return}let y=n?"opened":"closed",E=a.onSwitched(b=>{["opened","closed"].includes(b)&&b!==y&&a.emit(qe.TOGGLE_OPEN)});return a.emit(qe.TOGGLE_OPEN),E},[a,n]);let[l,p]=q(void 0),[d,m]=q(void 0);return fe(()=>void(l&&m(l.scrollHeight)),[l,t]),qt.default("div",{className:`vertical-animation-container ${s}`,style:`max-height: ${d}px`},qt.default(ks,{setRef:p},t))});var Ne=Ce(ze());var Ai=G(e=>{let{children:t,hidden:n}=e||{};return Ne.default("div",{className:Re("dialog",{hidden:n})},t)}),Di=G(e=>{let{children:t}=e||{};return Ne.default("h1",null,"OBIS | ",t)}),Oi=G(e=>{let{children:t}=e||{};return Ne.default("h2",null,t)}),wt=G(e=>{let{children:t}=e||{},{className:n,handleClick:r,disabled:s}=e||{};return Ne.default("button",{className:n,onclick:r,disabled:s},t)}),xi=G(e=>{let{value:t,max:n=15,handleUpdate:r,disabled:s}=e||{};return Ne.default("input",{className:"fetch-slider",type:"range",min:"1",max:n,oninput:r,onchange:r,value:t,disabled:s})}),Ci=G(e=>{let{value:t,max:n}=e||{};return Ne.default("progress",{value:t,max:n})}),Ii=G(e=>{let{children:t}=e||{};return Ne.default("div",{className:"account"},t)}),Ri=G(e=>{let{children:t}=e||{};return Ne.default("div",{className:"accounts"},t)}),Pi=G(e=>{let{children:t}=e||{};return Ne.default("div",{className:"statements-loaded"},t)}),Mi=G(e=>{let{children:t}=e||{};return Ne.default("div",{className:"years-loaded"},t)}),_i=G(e=>{let{children:t}=e||{};return Ne.default("h3",{className:"account-name"},t)}),ki=G(e=>{let{children:t}=e||{};return Ne.default("div",{className:"actions"},t)});var Bt=Ce(lt());var{fetchMachine:ot}=obis,{Statebot:js,messages:Fs}=obis.deps,{Emit:vt}=ot,Ls=10,$i=3,ji=js("UI",{events:Fs,chart:`

    loading ->
    rendering-ui ->
      closed -> opened -> closed

  `,startIn:"loading",logLevel:2});ji.performTransitions({"loading -> rendering-ui":{on:P.ui.RENDERED,then:Bt.Delay(vt(P.FIRST_RUN),Bt.seconds(.1))},"rendering-ui -> closed":{on:P.FIRST_RUN},"closed -> opened -> closed":{on:P.ui.TOGGLE_OPEN}});var zt={max:0,value:0},Fi=G(()=>{let e=jn(ji),t=!["idle","loading"].includes(e),n=e==="closed",r=e==="opened",[s,a]=q($i),u=re(vt(P.ui.TOGGLE_OPEN),[]),f=re(m=>{let y=parseInt(m?.target?.value,10);a(isNaN(y)?$i:y)},[a]),l=re(vt(P.get.ACCOUNTS,s),[s]),p=re(vt(P.ui.VIEW_STATEMENTS),[]),d=re(vt(P.ui.DOWNLOAD_STATEMENTS),[]);return ie.default(Ai,{hidden:!t},t&&ie.default(wt,{className:Re("toggle-button",{opened:r,closed:n}),handleClick:u,disabled:!r&&!n},"\u21E7"),ie.default(Di,null,obis.plugin.name),ie.default(Oi,null,t?r?"Hit the button below to try and download everything automatically.":"Welcome! Click that button on the right to see if we can download some statements.":"Loading...",ie.default("br",null),ie.default("br",null),ot.inState({"getting-accounts":"Finding accounts...","getting-statements":"Getting statements...","getting-entries":"Getting transactions..."}),ie.default(Ci,{...zt})),t&&ie.default(Ni,{opened:r},ie.default(Ri,null,Z().accounts.map(m=>{let y=Z().statements.filter(b=>b.accountId===m.id).map(b=>new Date(b.endDate).getFullYear()),E=[...new Set(y)];return ie.default(Ii,{key:m.id},ie.default(Pi,null,"Statements: ",y.length),ie.default(Mi,null,E.join(" ")),ie.default(_i,null,m.sortCode," ",m.accountNumber))})),ie.default(ki,null,ie.default(xi,{max:Ls,value:s,handleUpdate:f,disabled:!ot.inState("idle")}),ie.default(wt,{handleClick:l,className:"fetch-everything",disabled:!ot.inState("idle")},"Fetch ",s," ",s==1?"year":"years"),ie.default(wt,{handleClick:p,disabled:!ot.inState("found-entries")},"View statements"),ie.default(wt,{handleClick:d,disabled:!ot.inState("found-entries")},"Download all"))))});var w=Ce(ze());var{messages:Ln}=obis.deps;function Nt(){let[e,t]=q(Z().accounts);return fe(()=>{let n=Ln.on(P.STORE_UPDATED,()=>{t(Z().accounts)});return()=>n()},[]),e}function Un(){let[e,t]=q(Z().statements);return fe(()=>{let n=Ln.on(P.STORE_UPDATED,()=>{let r=[...Z().statements].sort(Ye("endDate")).reverse();t(r)});return()=>n()},[]),e}function Li(){let[e,t]=q(Z().entries);return fe(()=>{let n=Ln.on(P.STORE_UPDATED,()=>{let r=[...Z().entries].sort(Ye("date")).reverse();t(r)});return()=>n()},[]),e}var Us={sortCode:"",accountNumber:""};function Ui(e){let t=Nt(),[n,r]=q(),[s,a]=q();fe(()=>{let y=t.find(A=>A.id===e),{sortCode:E,accountNumber:b}=y??Us,S=`${E} ${b}`;r(y),a(S)},[t,e,r,a]);let u=Un(),f=it(()=>u.filter(y=>y.accountId===e),[u,e]),l=re(()=>f[0]?.id,[f]),p=re(y=>{let E=f.map((b,S)=>b.id===y?S:null).filter(b=>b!==null)[0];return f[Math.max(0,E-1)]?.id},[f]),d=re(y=>{let E=f.map((b,S)=>b.id===y?S:null).filter(b=>b!==null)[0];return f[Math.min(f.length-1,E+1)]?.id},[f]),m=re(y=>f.map(b=>({dateDelta:Math.abs(y-b.endDate),id:b.id})).sort(Ye("dateDelta"))[0]?.id??l(),[f]);return{account:n,accountInfo:s,accountStatements:f,getNewest:l,getNewerThan:p,getOlderThan:d,getNearestToDate:m}}function qn(e){let t=Un(),{startDate:n,startBalance:r,endDate:s,endBalance:a}=it(()=>t.find(S=>S.id===e)??{},[t,e]),u=Li(),[f,l]=q([]),[p,d]=q(0),[m,y]=q(0),[E,b]=q(0);return fe(()=>{let S=u.filter(J=>J.statementId===e);l(S);let A=S.reduce((J,ne)=>J+ne.debit,0),O=S.reduce((J,ne)=>J+ne.credit,0),$=O-A;d(isNaN(A)?0:A),y(isNaN(O)?0:O),b(isNaN($)?0:$)},[e,u,l]),{entries:f,startDate:n,startBalance:r,endDate:s,endBalance:a,totalDebit:p,totalCredit:m,creditDebitDiff:E}}function qi(){let e=window.open("text/html","obis","width=1000,height=750,menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1");return e.document.writeln(`
    <html>
      <head>
        <title>Statements</title>
        <style type="text/css">
          @import url('${obis.rootPath}/statement.css');
        </style>
      </head>
      <body
        onload="opener.messages.emit('${P.ui.STATEMENTS_WINDOW_READY}');"
        onunload="opener.messages.emit('${P.ui.STATEMENTS_WINDOW_CLOSED}');"
      >
      </body>
    </html>
  `),e.document.close(),e}var qs=G(e=>{let{children:t=[]}=e||{};return t}),Bs=G(e=>{let{selectedAccountId:t,handleClick:n}=e,r=Nt(),s=re(a=>{let u=a?.path.map(f=>f?.dataset?.account).filter(Boolean)[0];n(u)},[n]);return r.map(a=>w.default("div",{onclick:s,key:a.id,"data-account":a.id,className:Re("account",{selected:a.id===t})},w.default("div",{className:"statements-loaded"}),w.default("div",{className:"years-loaded"}),w.default("div",{className:"account-name"},a.sortCode," ",a.accountNumber)))}),zs=G(e=>{let{children:t=[]}=e||{};return t}),Hs=G(e=>{let t="Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec".split("|"),{selectedMonth:n,months:r=[],handleClick:s}=e||{},a=re(u=>s(u?.target?.dataset?.month),[s]);return t.map((u,f)=>w.default("div",{onclick:a,key:u,"data-month":f,className:Re("month",{selected:f===n,"no-entries":!r.includes(f)})},u))}),Gs=G(e=>{let{selectedYear:t,years:n=[],handleClick:r}=e||{},s=re(a=>r(a?.target?.dataset?.year),[r]);return n.map(a=>w.default("div",{onclick:s,key:a,"data-year":a,className:Re("year",{selected:a==t})},a))}),Vs=G(e=>{let{selectedStatementId:t}=e,{entries:n,startBalance:r,endBalance:s}=qn(t),a=0,u=0,f=r??0,l=n.map(d=>{let{id:m,date:y,type:E,payee:b,note:S,debit:A,credit:O,balance:$}=d;return u-=A,a+=O,f+=O-A,w.default("tr",{key:m},w.default("td",{className:"no-wrap"},yt(y)),w.default("td",null,E),w.default("td",null,b),w.default("td",null,S),w.default("td",{className:"currency"},L(A)),w.default("td",{className:"currency"},L(O)),w.default("td",{className:Re("currency",{negative:$<0})},L($)),w.default("td",{className:Re("currency",{negative:f<0})},L(f)))}),p;return l.length||(p=w.default("tr",null,w.default("td",{className:"no-wrap no-entries",colspan:"8"},"No entries for this period"))),w.default("table",{className:"statement"},w.default("thead",null,w.default("tr",{className:"table-header"},w.default("th",null,"Date"),w.default("th",null,"Type"),w.default("th",null,"Description"),w.default("th",null,"Memo"),w.default("th",null,"Debit"),w.default("th",null,"Credit"),w.default("th",null,"Balance"),w.default("th",null,"(Calculated)"))),w.default("tbody",null,l.length?l:p),w.default("tfoot",null,w.default("tr",{className:"table-footer"},w.default("th",null,"\xA0"),w.default("th",null,"\xA0"),w.default("th",null,"\xA0"),w.default("th",null,"\xA0"),w.default("th",{className:"currency"},L(u)),w.default("th",{className:"currency"},L(a)),w.default("th",{className:"currency"},L(s)),w.default("th",{className:"currency"},L(f)))))}),Bi=G(()=>{let e=Nt(),[t,n]=q(e[0]?.id),{accountInfo:r,accountStatements:s,getNewest:a,getNewerThan:u,getOlderThan:f,getNearestToDate:l}=Ui(t),[p,d]=q(a()),[m,y]=q(s.find(F=>F.id===p)?.endDate);fe(()=>{let F=s.find(X=>X.id===p);if(F)y(F.endDate);else{let X=l(m);d(X)}},[s,p,m,d,y,l]);let E=new Date(m),[b,S]=q(E.getMonth()),[A,O]=q(E.getFullYear());fe(()=>{let F=new Date(m);S(F.getMonth()),O(F.getFullYear())},[m]);let[$,J]=q([]),[ne,B]=q([]);fe(()=>{let F=s.map(Te=>new Date(Te.endDate).getFullYear()),X=[...new Set(F)],je=s.filter(Te=>new Date(Te.endDate).getFullYear()==A).map(Te=>new Date(Te.endDate).getMonth()),Pe=[...new Set(je)];J(X),B(Pe)},[s,m,A]);let _=qn(p),{totalDebit:U,totalCredit:se,creditDebitDiff:W}=_,Ae=re(F=>n(F),[n]),pe=re(()=>d(a()),[d,a]),ee=re(()=>d(f(p)),[d,f,p]),$e=re(()=>d(u(p)),[d,u,p]),be=F=>{let X=new Date(m);X.setMonth(F),d(l(X))},Se=F=>{let X=new Date(m);X.setFullYear(F),d(l(X))};return w.default("div",{className:"grid-container"},w.default("div",{className:"header"},w.default("div",{className:"info-and-accounts"},w.default("div",{className:"info"},w.default(qs,null,w.default("h1",null,"OBIS | Statements Browser"),w.default("h2",null,r," \u2022"," ",!isNaN(m)&&yt(m)),w.default("div",{className:"balance-summary"},se>0&&w.default("span",null,L(se)," in"),U>0&&w.default("span",null,L(U)," out"),W!==0&&w.default("span",{className:Re({black:W>0,red:W<0})},W<=0?"\u{1F4C9} ":"\u{1F4C8} ",L(W))))),w.default("div",{className:"accounts"},w.default(Bs,{selectedAccountId:t,handleClick:Ae}))),w.default("div",{className:"cursor-and-months"},w.default("div",{className:"months"},w.default(Hs,{months:ne,selectedMonth:b,handleClick:be})),w.default("div",{className:"cursor"},w.default(zs,null,w.default("div",{onclick:ee},"Older"),w.default("div",{onclick:pe},"\u2022"),w.default("div",{onclick:$e},"Newer"))))),w.default("div",{className:"main"},w.default(Vs,{selectedStatementId:p})),w.default("div",{className:"years"},w.default("div",null,w.default(Gs,{years:$,selectedYear:A,handleClick:Se}))),w.default("div",{className:"spacing"}))});var{fetchMachine:Hi}=obis,{messages:Gi}=obis.deps,{on:Dt,emit:Ys}=Gi,{Emit:Vi}=Hi;window.store=Z;window.actions=P;window.messages=Gi;function Ws(){let e=qi();At.default.mount(e.document.body,Bi);let t=Dt(P.ui.CLOSE_STATEMENTS_WINDOW,()=>{t(),e.close()})}Dt(P.ui.VIEW_STATEMENTS,Ws);Dt(P.ui.DOWNLOAD_STATEMENTS,()=>{ii().finally(()=>Bn.delay(zi.seconds(3))).finally(Vi(P.ui.DOWNLOADED_STATEMENTS))});function Js(){Ys(P.ui.RENDERING,At.default);let e=document.querySelector("#obis-root")||document.body.appendChild(Ks(document.createElement("div"),{id:"obis-root"}));At.default.mount(e,Fi);let t=()=>requestAnimationFrame(()=>At.default.redraw());Hi.onSwitched(t),Dt(P.STORE_UPDATED,t),Dt(P.ui.UPDATE_PROGRESS_BAR,n=>{let r=n.max,s=n.value;zt.max=r,zt.value=s,t()}),Bn.delay().then(Vi(P.ui.RENDERED))}function Ks(e,t){return Object.entries(t).reduce((n,[r,s])=>(n[r]=s,n),e)}Js();})();
